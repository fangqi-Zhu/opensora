[[34m2025-06-18 17:52:19[0m] Experiment directory created at /mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/19/sdxl_simplevla_debug/000-STDiT3-XL-2
[[34m2025-06-18 17:52:19[0m] Training configuration:
 {'adam_eps': 1e-15,
 'batch_size': 4,
 'cache_pin_memory': True,
 'ckpt_every': 10000,
 'config': 'configs/libero/train/sdxl_simplevla_web.py',
 'dataset': {'Ta': 8,
             'To': 4,
             'action_dim': 7,
             'episode_buf_size': 30,
             'episode_per_shard': 10,
             'image_size': (256, 256),
             'sample_buf_size': 10000,
             'shards_pattern': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/webdataset_shards/06/16/*.tar',
             'stats_path': '/mnt/hdfs/zhufangqi/datasets/libero/dataset_statistics.json',
             'stride': 1,
             'type': 'SimpleVLAWebDataset'},
 'dtype': 'bf16',
 'ema_decay': 0.99,
 'epochs': 10000,
 'grad_checkpoint': False,
 'grad_clip': 1.0,
 'load': None,
 'log_every': 10,
 'lr': 0.0001,
 'mask_ratios': {'video_obs_4_frame': 1.0},
 'model': {'action_dim': 7,
           'cfg': False,
           'enable_flash_attn': True,
           'enable_layernorm_kernel': True,
           'freeze_y_embedder': True,
           'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/hpcai-tech/OpenSora-STDiT-v3/model.safetensors',
           'pad_action_num': 4,
           'qk_norm': True,
           'skip_y_embedder': True,
           'training': True,
           'type': 'STDiT3-XL/2'},
 'num_workers': 4,
 'outputs': '/mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/19/sdxl_simplevla_debug',
 'pin_memory_cache_pre_alloc_numels': [325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560],
 'plugin': 'zero2',
 'record_time': False,
 'scheduler': {'sample_method': 'logit-normal',
               'type': 'rflow',
               'use_timestep_transform': True},
 'seed': 42,
 'start_from_scratch': False,
 'vae': {'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/stabilityai/stable-diffusion-xl-base-1.0/vae',
         'micro_batch_size': 64,
         'micro_frame_size': 8,
         'type': 'SDXL'},
 'wandb': True,
 'warmup_steps': 1000}
[[34m2025-06-18 17:52:21[0m] Building dataset...
[[34m2025-06-18 17:54:09[0m] Experiment directory created at /mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/19/sdxl_simplevla_debug/001-STDiT3-XL-2
[[34m2025-06-18 17:54:09[0m] Training configuration:
 {'adam_eps': 1e-15,
 'batch_size': 4,
 'cache_pin_memory': True,
 'ckpt_every': 10000,
 'config': 'configs/libero/train/sdxl_simplevla_web.py',
 'dataset': {'Ta': 8,
             'To': 4,
             'action_dim': 7,
             'episode_buf_size': 30,
             'episode_per_shard': 10,
             'image_size': (256, 256),
             'sample_buf_size': 10000,
             'shards_pattern': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/webdataset_shards/06/16/*.tar',
             'stats_path': '/mnt/hdfs/zhufangqi/datasets/libero/dataset_statistics.json',
             'stride': 1,
             'type': 'SimpleVLAWebDataset'},
 'dtype': 'bf16',
 'ema_decay': 0.99,
 'epochs': 10000,
 'grad_checkpoint': False,
 'grad_clip': 1.0,
 'load': None,
 'log_every': 10,
 'lr': 0.0001,
 'mask_ratios': {'video_obs_4_frame': 1.0},
 'model': {'action_dim': 7,
           'cfg': False,
           'enable_flash_attn': True,
           'enable_layernorm_kernel': True,
           'freeze_y_embedder': True,
           'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/hpcai-tech/OpenSora-STDiT-v3/model.safetensors',
           'pad_action_num': 4,
           'qk_norm': True,
           'skip_y_embedder': True,
           'training': True,
           'type': 'STDiT3-XL/2'},
 'num_workers': 4,
 'outputs': '/mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/19/sdxl_simplevla_debug',
 'pin_memory_cache_pre_alloc_numels': [325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560],
 'plugin': 'zero2',
 'record_time': False,
 'scheduler': {'sample_method': 'logit-normal',
               'type': 'rflow',
               'use_timestep_transform': True},
 'seed': 42,
 'start_from_scratch': False,
 'vae': {'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/stabilityai/stable-diffusion-xl-base-1.0/vae',
         'micro_batch_size': 64,
         'micro_frame_size': 8,
         'type': 'SDXL'},
 'wandb': True,
 'warmup_steps': 1000}
[[34m2025-06-18 17:54:10[0m] Building dataset...
[[34m2025-06-18 17:54:10[0m] Dataset contains unknown number of samples.
[[34m2025-06-18 17:55:51[0m] Experiment directory created at /mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/19/sdxl_simplevla_debug/002-STDiT3-XL-2
[[34m2025-06-18 17:55:51[0m] Training configuration:
 {'adam_eps': 1e-15,
 'batch_size': 4,
 'cache_pin_memory': True,
 'ckpt_every': 10000,
 'config': 'configs/libero/train/sdxl_simplevla_web.py',
 'dataset': {'Ta': 8,
             'To': 4,
             'action_dim': 7,
             'episode_buf_size': 30,
             'episode_per_shard': 10,
             'image_size': (256, 256),
             'sample_buf_size': 10000,
             'shards_pattern': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/webdataset_shards/06/16/*.tar',
             'stats_path': '/mnt/hdfs/zhufangqi/datasets/libero/dataset_statistics.json',
             'stride': 1,
             'type': 'SimpleVLAWebDataset'},
 'dtype': 'bf16',
 'ema_decay': 0.99,
 'epochs': 10000,
 'grad_checkpoint': False,
 'grad_clip': 1.0,
 'load': None,
 'log_every': 10,
 'lr': 0.0001,
 'mask_ratios': {'video_obs_4_frame': 1.0},
 'model': {'action_dim': 7,
           'cfg': False,
           'enable_flash_attn': True,
           'enable_layernorm_kernel': True,
           'freeze_y_embedder': True,
           'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/hpcai-tech/OpenSora-STDiT-v3/model.safetensors',
           'pad_action_num': 4,
           'qk_norm': True,
           'skip_y_embedder': True,
           'training': True,
           'type': 'STDiT3-XL/2'},
 'num_workers': 4,
 'outputs': '/mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/19/sdxl_simplevla_debug',
 'pin_memory_cache_pre_alloc_numels': [325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560],
 'plugin': 'zero2',
 'record_time': False,
 'scheduler': {'sample_method': 'logit-normal',
               'type': 'rflow',
               'use_timestep_transform': True},
 'seed': 42,
 'start_from_scratch': False,
 'vae': {'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/stabilityai/stable-diffusion-xl-base-1.0/vae',
         'micro_batch_size': 64,
         'micro_frame_size': 8,
         'type': 'SDXL'},
 'wandb': True,
 'warmup_steps': 1000}
[[34m2025-06-18 17:55:53[0m] Building dataset...
[[34m2025-06-18 17:55:53[0m] Dataset contains unknown number of samples.
[[34m2025-06-18 17:55:53[0m] Building models...
[[34m2025-06-18 17:57:10[0m] Experiment directory created at /mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/19/sdxl_simplevla_debug/003-STDiT3-XL-2
[[34m2025-06-18 17:57:10[0m] Training configuration:
 {'adam_eps': 1e-15,
 'batch_size': 4,
 'cache_pin_memory': True,
 'ckpt_every': 10000,
 'config': 'configs/libero/train/sdxl_simplevla_web.py',
 'dataset': {'Ta': 8,
             'To': 4,
             'action_dim': 7,
             'episode_buf_size': 30,
             'episode_per_shard': 10,
             'image_size': (256, 256),
             'sample_buf_size': 10000,
             'shards_pattern': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/webdataset_shards/06/16/*.tar',
             'stats_path': '/mnt/hdfs/zhufangqi/datasets/libero/dataset_statistics.json',
             'stride': 1,
             'type': 'SimpleVLAWebDataset'},
 'dtype': 'bf16',
 'ema_decay': 0.99,
 'epochs': 10000,
 'grad_checkpoint': False,
 'grad_clip': 1.0,
 'load': None,
 'log_every': 10,
 'lr': 0.0001,
 'mask_ratios': {'video_obs_4_frame': 1.0},
 'model': {'action_dim': 7,
           'cfg': False,
           'enable_flash_attn': True,
           'enable_layernorm_kernel': True,
           'freeze_y_embedder': True,
           'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/hpcai-tech/OpenSora-STDiT-v3/model.safetensors',
           'pad_action_num': 4,
           'qk_norm': True,
           'skip_y_embedder': True,
           'training': True,
           'type': 'STDiT3-XL/2'},
 'num_workers': 4,
 'outputs': '/mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/19/sdxl_simplevla_debug',
 'pin_memory_cache_pre_alloc_numels': [325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560],
 'plugin': 'zero2',
 'record_time': False,
 'scheduler': {'sample_method': 'logit-normal',
               'type': 'rflow',
               'use_timestep_transform': True},
 'seed': 42,
 'start_from_scratch': False,
 'vae': {'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/stabilityai/stable-diffusion-xl-base-1.0/vae',
         'micro_batch_size': 64,
         'micro_frame_size': 8,
         'type': 'SDXL'},
 'wandb': True,
 'warmup_steps': 1000}
[[34m2025-06-18 17:57:11[0m] Building dataset...
[[34m2025-06-18 17:57:11[0m] Dataset contains unknown number of samples.
[[34m2025-06-18 17:57:11[0m] Building models...
[[34m2025-06-18 17:57:26[0m] [Diffusion] Trainable model params: 1.12 B, Total model params: 1.13 B
[[34m2025-06-18 17:57:29[0m] mask ratios: {'video_obs_4_frame': 1.0, 'identity': 0.0}
[[34m2025-06-18 17:57:29[0m] Preparing for distributed training...
[[34m2025-06-18 17:57:29[0m] Boosting model for distributed training
[[34m2025-06-18 17:57:29[0m] Training for 10000 epochs with 10000000000000000000000 steps per epoch
[[34m2025-06-18 17:57:30[0m] Beginning epoch 0...
[[34m2025-06-18 18:00:09[0m] Experiment directory created at /mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/19/sdxl_simplevla_debug/004-STDiT3-XL-2
[[34m2025-06-18 18:00:09[0m] Training configuration:
 {'adam_eps': 1e-15,
 'batch_size': 4,
 'cache_pin_memory': False,
 'ckpt_every': 10000,
 'config': 'configs/libero/train/sdxl_simplevla_web.py',
 'dataset': {'Ta': 8,
             'To': 4,
             'action_dim': 7,
             'episode_buf_size': 30,
             'episode_per_shard': 10,
             'image_size': (256, 256),
             'sample_buf_size': 10000,
             'shards_pattern': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/webdataset_shards/06/16/*.tar',
             'stats_path': '/mnt/hdfs/zhufangqi/datasets/libero/dataset_statistics.json',
             'stride': 1,
             'type': 'SimpleVLAWebDataset'},
 'dtype': 'bf16',
 'ema_decay': 0.99,
 'epochs': 10000,
 'grad_checkpoint': False,
 'grad_clip': 1.0,
 'load': None,
 'log_every': 10,
 'lr': 0.0001,
 'mask_ratios': {'video_obs_4_frame': 1.0},
 'model': {'action_dim': 7,
           'cfg': False,
           'enable_flash_attn': True,
           'enable_layernorm_kernel': True,
           'freeze_y_embedder': True,
           'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/hpcai-tech/OpenSora-STDiT-v3/model.safetensors',
           'pad_action_num': 4,
           'qk_norm': True,
           'skip_y_embedder': True,
           'training': True,
           'type': 'STDiT3-XL/2'},
 'num_workers': 4,
 'outputs': '/mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/19/sdxl_simplevla_debug',
 'pin_memory_cache_pre_alloc_numels': [325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560],
 'plugin': 'zero2',
 'record_time': False,
 'scheduler': {'sample_method': 'logit-normal',
               'type': 'rflow',
               'use_timestep_transform': True},
 'seed': 42,
 'start_from_scratch': False,
 'vae': {'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/stabilityai/stable-diffusion-xl-base-1.0/vae',
         'micro_batch_size': 64,
         'micro_frame_size': 8,
         'type': 'SDXL'},
 'wandb': True,
 'warmup_steps': 1000}
[[34m2025-06-18 18:00:10[0m] Building dataset...
[[34m2025-06-18 18:00:10[0m] Dataset contains unknown number of samples.
[[34m2025-06-18 18:00:10[0m] Building models...
[[34m2025-06-18 18:00:25[0m] [Diffusion] Trainable model params: 1.12 B, Total model params: 1.13 B
[[34m2025-06-18 18:00:28[0m] mask ratios: {'video_obs_4_frame': 1.0, 'identity': 0.0}
[[34m2025-06-18 18:00:28[0m] Preparing for distributed training...
[[34m2025-06-18 18:00:28[0m] Boosting model for distributed training
[[34m2025-06-18 18:00:28[0m] Training for 10000 epochs with 10000000000000000000000 steps per epoch
[[34m2025-06-18 18:00:29[0m] Beginning epoch 0...
[[34m2025-06-20 06:08:51[0m] Experiment directory created at /mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla_debug/000-STDiT3-XL-2
[[34m2025-06-20 06:08:51[0m] Training configuration:
 {'adam_eps': 1e-15,
 'batch_size': 4,
 'cache_pin_memory': False,
 'ckpt_every': 10000,
 'config': 'configs/libero/train/sdxl_simplevla_web.py',
 'dataset': {'Ta': 8,
             'To': 4,
             'action_dim': 7,
             'episode_buf_size': 50,
             'episode_per_shard': 30,
             'image_size': (256, 256),
             'sample_buf_size': 10000,
             'shards_pattern': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/webdataset_shards/06/17_mp/*.tar',
             'stats_path': '/mnt/hdfs/zhufangqi/datasets/libero/dataset_statistics.json',
             'stride': 1,
             'type': 'SimpleVLAWebDataset'},
 'dtype': 'bf16',
 'ema_decay': 0.99,
 'epochs': 10000,
 'grad_checkpoint': False,
 'grad_clip': 1.0,
 'load': None,
 'log_every': 10,
 'lr': 0.0001,
 'mask_ratios': {'video_obs_4_frame': 1.0},
 'model': {'action_dim': 7,
           'cfg': False,
           'enable_flash_attn': True,
           'enable_layernorm_kernel': True,
           'freeze_y_embedder': True,
           'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/hpcai-tech/OpenSora-STDiT-v3/model.safetensors',
           'pad_action_num': 4,
           'qk_norm': True,
           'skip_y_embedder': True,
           'training': True,
           'type': 'STDiT3-XL/2'},
 'num_workers': 4,
 'outputs': '/mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla_debug',
 'pin_memory_cache_pre_alloc_numels': [325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560],
 'plugin': 'zero2',
 'record_time': False,
 'scheduler': {'sample_method': 'logit-normal',
               'type': 'rflow',
               'use_timestep_transform': True},
 'seed': 42,
 'start_from_scratch': False,
 'vae': {'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/stabilityai/stable-diffusion-xl-base-1.0/vae',
         'micro_batch_size': 64,
         'micro_frame_size': 8,
         'type': 'SDXL'},
 'wandb': True,
 'warmup_steps': 1000}
[[34m2025-06-20 06:08:54[0m] Building dataset...
[[34m2025-06-20 06:12:03[0m] Experiment directory created at /mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla_debug/001-STDiT3-XL-2
[[34m2025-06-20 06:12:03[0m] Training configuration:
 {'adam_eps': 1e-15,
 'batch_size': 4,
 'cache_pin_memory': False,
 'ckpt_every': 10000,
 'config': 'configs/libero/train/sdxl_simplevla_web.py',
 'dataset': {'Ta': 8,
             'To': 4,
             'action_dim': 7,
             'episode_buf_size': 50,
             'episode_per_shard': 30,
             'image_size': (256, 256),
             'sample_buf_size': 10000,
             'shards_pattern': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/webdataset_shards/06/17_mp/*.tar',
             'stats_path': '/mnt/hdfs/zhufangqi/datasets/libero/dataset_statistics.json',
             'stride': 1,
             'type': 'SimpleVLAWebDataset'},
 'dtype': 'bf16',
 'ema_decay': 0.99,
 'epochs': 10000,
 'grad_checkpoint': False,
 'grad_clip': 1.0,
 'load': None,
 'log_every': 10,
 'lr': 0.0001,
 'mask_ratios': {'video_obs_4_frame': 1.0},
 'model': {'action_dim': 7,
           'cfg': False,
           'enable_flash_attn': True,
           'enable_layernorm_kernel': True,
           'freeze_y_embedder': True,
           'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/hpcai-tech/OpenSora-STDiT-v3/model.safetensors',
           'pad_action_num': 4,
           'qk_norm': True,
           'skip_y_embedder': True,
           'training': True,
           'type': 'STDiT3-XL/2'},
 'num_workers': 4,
 'outputs': '/mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla_debug',
 'pin_memory_cache_pre_alloc_numels': [325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560],
 'plugin': 'zero2',
 'record_time': False,
 'scheduler': {'sample_method': 'logit-normal',
               'type': 'rflow',
               'use_timestep_transform': True},
 'seed': 42,
 'start_from_scratch': False,
 'vae': {'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/stabilityai/stable-diffusion-xl-base-1.0/vae',
         'micro_batch_size': 64,
         'micro_frame_size': 8,
         'type': 'SDXL'},
 'wandb': True,
 'warmup_steps': 1000}
[[34m2025-06-20 06:12:05[0m] Building dataset...
[[34m2025-06-20 06:13:53[0m] Experiment directory created at /mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla_debug/002-STDiT3-XL-2
[[34m2025-06-20 06:13:53[0m] Training configuration:
 {'adam_eps': 1e-15,
 'batch_size': 4,
 'cache_pin_memory': False,
 'ckpt_every': 10000,
 'config': 'configs/libero/train/sdxl_simplevla_web.py',
 'dataset': {'Ta': 8,
             'To': 4,
             'action_dim': 7,
             'episode_buf_size': 50,
             'episode_per_shard': 30,
             'image_size': (256, 256),
             'sample_buf_size': 10000,
             'shards_pattern': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/webdataset_shards/06/17_mp/*.tar',
             'stats_path': '/mnt/hdfs/zhufangqi/datasets/libero/dataset_statistics.json',
             'stride': 1,
             'type': 'SimpleVLAWebDataset'},
 'dtype': 'bf16',
 'ema_decay': 0.99,
 'epochs': 10000,
 'grad_checkpoint': False,
 'grad_clip': 1.0,
 'load': None,
 'log_every': 10,
 'lr': 0.0001,
 'mask_ratios': {'video_obs_4_frame': 1.0},
 'model': {'action_dim': 7,
           'cfg': False,
           'enable_flash_attn': True,
           'enable_layernorm_kernel': True,
           'freeze_y_embedder': True,
           'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/hpcai-tech/OpenSora-STDiT-v3/model.safetensors',
           'pad_action_num': 4,
           'qk_norm': True,
           'skip_y_embedder': True,
           'training': True,
           'type': 'STDiT3-XL/2'},
 'num_workers': 4,
 'outputs': '/mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla_debug',
 'pin_memory_cache_pre_alloc_numels': [325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560],
 'plugin': 'zero2',
 'record_time': False,
 'scheduler': {'sample_method': 'logit-normal',
               'type': 'rflow',
               'use_timestep_transform': True},
 'seed': 42,
 'start_from_scratch': False,
 'vae': {'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/stabilityai/stable-diffusion-xl-base-1.0/vae',
         'micro_batch_size': 64,
         'micro_frame_size': 8,
         'type': 'SDXL'},
 'wandb': True,
 'warmup_steps': 1000}
[[34m2025-06-20 06:13:55[0m] Building dataset...
[[34m2025-06-20 06:27:21[0m] Experiment directory created at /mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla_debug/003-STDiT3-XL-2
[[34m2025-06-20 06:27:21[0m] Training configuration:
 {'adam_eps': 1e-15,
 'batch_size': 4,
 'cache_pin_memory': False,
 'ckpt_every': 10000,
 'config': 'configs/libero/train/sdxl_simplevla_web.py',
 'dataset': {'Ta': 8,
             'To': 4,
             'action_dim': 7,
             'episode_buf_size': 50,
             'episode_per_shard': 30,
             'image_size': (256, 256),
             'sample_buf_size': 10000,
             'shards_pattern': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/webdataset_shards/06/17_mp/**/*.tar',
             'stats_path': '/mnt/hdfs/zhufangqi/datasets/libero/dataset_statistics.json',
             'stride': 1,
             'type': 'SimpleVLAWebDataset'},
 'dtype': 'bf16',
 'ema_decay': 0.99,
 'epochs': 10000,
 'grad_checkpoint': False,
 'grad_clip': 1.0,
 'load': None,
 'log_every': 10,
 'lr': 0.0001,
 'mask_ratios': {'video_obs_4_frame': 1.0},
 'model': {'action_dim': 7,
           'cfg': False,
           'enable_flash_attn': True,
           'enable_layernorm_kernel': True,
           'freeze_y_embedder': True,
           'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/hpcai-tech/OpenSora-STDiT-v3/model.safetensors',
           'pad_action_num': 4,
           'qk_norm': True,
           'skip_y_embedder': True,
           'training': True,
           'type': 'STDiT3-XL/2'},
 'num_workers': 4,
 'outputs': '/mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla_debug',
 'pin_memory_cache_pre_alloc_numels': [325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560],
 'plugin': 'zero2',
 'record_time': False,
 'scheduler': {'sample_method': 'logit-normal',
               'type': 'rflow',
               'use_timestep_transform': True},
 'seed': 42,
 'start_from_scratch': False,
 'vae': {'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/stabilityai/stable-diffusion-xl-base-1.0/vae',
         'micro_batch_size': 64,
         'micro_frame_size': 8,
         'type': 'SDXL'},
 'wandb': True,
 'warmup_steps': 1000}
[[34m2025-06-20 06:27:24[0m] Building dataset...
[[34m2025-06-20 06:27:24[0m] Dataset contains unknown number of samples.
[[34m2025-06-20 06:27:24[0m] Building models...
[[34m2025-06-20 06:27:42[0m] [Diffusion] Trainable model params: 1.12 B, Total model params: 1.13 B
[[34m2025-06-20 06:27:48[0m] mask ratios: {'video_obs_4_frame': 1.0, 'identity': 0.0}
[[34m2025-06-20 06:27:48[0m] Preparing for distributed training...
[[34m2025-06-20 06:27:49[0m] Boosting model for distributed training
[[34m2025-06-20 06:27:49[0m] Training for 10000 epochs with 1000000 steps per epoch
[[34m2025-06-20 06:27:50[0m] Beginning epoch 0...
[[34m2025-06-20 06:33:14[0m] Experiment directory created at /mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla_debug/004-STDiT3-XL-2
[[34m2025-06-20 06:33:14[0m] Training configuration:
 {'adam_eps': 1e-15,
 'batch_size': 4,
 'cache_pin_memory': False,
 'ckpt_every': 10000,
 'config': 'configs/libero/train/sdxl_simplevla_web.py',
 'dataset': {'Ta': 8,
             'To': 4,
             'action_dim': 7,
             'episode_buf_size': 50,
             'episode_per_shard': 30,
             'image_size': (256, 256),
             'sample_buf_size': 10000,
             'shards_pattern': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/webdataset_shards/06/17_mp/**/*.tar',
             'stats_path': '/mnt/hdfs/zhufangqi/datasets/libero/dataset_statistics.json',
             'stride': 1,
             'type': 'SimpleVLAWebDataset'},
 'dtype': 'bf16',
 'ema_decay': 0.99,
 'epochs': 10000,
 'grad_checkpoint': False,
 'grad_clip': 1.0,
 'load': None,
 'log_every': 10,
 'lr': 0.0001,
 'mask_ratios': {'video_obs_4_frame': 1.0},
 'model': {'action_dim': 7,
           'cfg': False,
           'enable_flash_attn': True,
           'enable_layernorm_kernel': True,
           'freeze_y_embedder': True,
           'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/hpcai-tech/OpenSora-STDiT-v3/model.safetensors',
           'pad_action_num': 4,
           'qk_norm': True,
           'skip_y_embedder': True,
           'training': True,
           'type': 'STDiT3-XL/2'},
 'num_workers': 2,
 'outputs': '/mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla_debug',
 'pin_memory_cache_pre_alloc_numels': [325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560],
 'plugin': 'zero2',
 'record_time': False,
 'scheduler': {'sample_method': 'logit-normal',
               'type': 'rflow',
               'use_timestep_transform': True},
 'seed': 42,
 'start_from_scratch': False,
 'vae': {'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/stabilityai/stable-diffusion-xl-base-1.0/vae',
         'micro_batch_size': 64,
         'micro_frame_size': 8,
         'type': 'SDXL'},
 'wandb': True,
 'warmup_steps': 1000}
[[34m2025-06-20 06:33:15[0m] Building dataset...
[[34m2025-06-20 06:33:15[0m] Dataset contains unknown number of samples.
[[34m2025-06-20 06:33:15[0m] Building models...
[[34m2025-06-20 06:33:48[0m] [Diffusion] Trainable model params: 1.12 B, Total model params: 1.13 B
[[34m2025-06-20 06:33:52[0m] mask ratios: {'video_obs_4_frame': 1.0, 'identity': 0.0}
[[34m2025-06-20 06:33:52[0m] Preparing for distributed training...
[[34m2025-06-20 06:33:52[0m] Boosting model for distributed training
[[34m2025-06-20 06:33:52[0m] Training for 10000 epochs with 1000000 steps per epoch
[[34m2025-06-20 06:33:53[0m] Beginning epoch 0...
[[34m2025-06-20 06:44:03[0m] Experiment directory created at /mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla_debug/005-STDiT3-XL-2
[[34m2025-06-20 06:44:03[0m] Training configuration:
 {'adam_eps': 1e-15,
 'batch_size': 4,
 'cache_pin_memory': False,
 'ckpt_every': 10000,
 'config': 'configs/libero/train/sdxl_simplevla_web.py',
 'dataset': {'Ta': 8,
             'To': 4,
             'action_dim': 7,
             'episode_buf_size': 10,
             'episode_per_shard': 30,
             'image_size': (256, 256),
             'sample_buf_size': 1000,
             'shards_pattern': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/webdataset_shards/06/17_mp/**/*.tar',
             'stats_path': '/mnt/hdfs/zhufangqi/datasets/libero/dataset_statistics.json',
             'stride': 1,
             'type': 'SimpleVLAWebDataset'},
 'dtype': 'bf16',
 'ema_decay': 0.99,
 'epochs': 10000,
 'grad_checkpoint': False,
 'grad_clip': 1.0,
 'load': None,
 'log_every': 10,
 'lr': 0.0001,
 'mask_ratios': {'video_obs_4_frame': 1.0},
 'model': {'action_dim': 7,
           'cfg': False,
           'enable_flash_attn': True,
           'enable_layernorm_kernel': True,
           'freeze_y_embedder': True,
           'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/hpcai-tech/OpenSora-STDiT-v3/model.safetensors',
           'pad_action_num': 4,
           'qk_norm': True,
           'skip_y_embedder': True,
           'training': True,
           'type': 'STDiT3-XL/2'},
 'num_workers': 4,
 'outputs': '/mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla_debug',
 'pin_memory_cache_pre_alloc_numels': [325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560],
 'plugin': 'zero2',
 'record_time': False,
 'scheduler': {'sample_method': 'logit-normal',
               'type': 'rflow',
               'use_timestep_transform': True},
 'seed': 42,
 'start_from_scratch': False,
 'vae': {'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/stabilityai/stable-diffusion-xl-base-1.0/vae',
         'micro_batch_size': 64,
         'micro_frame_size': 8,
         'type': 'SDXL'},
 'wandb': True,
 'warmup_steps': 1000}
[[34m2025-06-20 06:44:05[0m] Building dataset...
[[34m2025-06-20 06:44:05[0m] Dataset contains unknown number of samples.
[[34m2025-06-20 06:44:05[0m] Building models...
[[34m2025-06-20 06:44:38[0m] [Diffusion] Trainable model params: 1.12 B, Total model params: 1.13 B
[[34m2025-06-20 06:44:41[0m] mask ratios: {'video_obs_4_frame': 1.0, 'identity': 0.0}
[[34m2025-06-20 06:44:41[0m] Preparing for distributed training...
[[34m2025-06-20 06:44:42[0m] Boosting model for distributed training
[[34m2025-06-20 06:44:42[0m] Training for 10000 epochs with 1000000 steps per epoch
[[34m2025-06-20 06:44:44[0m] Beginning epoch 0...
[[34m2025-06-20 06:48:07[0m] Experiment directory created at /mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla_debug/006-STDiT3-XL-2
[[34m2025-06-20 06:48:07[0m] Training configuration:
 {'adam_eps': 1e-15,
 'batch_size': 4,
 'cache_pin_memory': False,
 'ckpt_every': 10000,
 'config': 'configs/libero/train/sdxl_simplevla_web.py',
 'dataset': {'Ta': 8,
             'To': 4,
             'action_dim': 7,
             'episode_buf_size': 50,
             'episode_per_shard': 30,
             'image_size': (256, 256),
             'sample_buf_size': 1000,
             'shards_pattern': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/webdataset_shards/06/17_mp/**/*.tar',
             'stats_path': '/mnt/hdfs/zhufangqi/datasets/libero/dataset_statistics.json',
             'stride': 1,
             'type': 'SimpleVLAWebDataset'},
 'dtype': 'bf16',
 'ema_decay': 0.99,
 'epochs': 10000,
 'grad_checkpoint': False,
 'grad_clip': 1.0,
 'load': None,
 'log_every': 10,
 'lr': 0.0001,
 'mask_ratios': {'video_obs_4_frame': 1.0},
 'model': {'action_dim': 7,
           'cfg': False,
           'enable_flash_attn': True,
           'enable_layernorm_kernel': True,
           'freeze_y_embedder': True,
           'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/hpcai-tech/OpenSora-STDiT-v3/model.safetensors',
           'pad_action_num': 4,
           'qk_norm': True,
           'skip_y_embedder': True,
           'training': True,
           'type': 'STDiT3-XL/2'},
 'num_workers': 4,
 'outputs': '/mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla_debug',
 'pin_memory_cache_pre_alloc_numels': [325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560],
 'plugin': 'zero2',
 'record_time': False,
 'scheduler': {'sample_method': 'logit-normal',
               'type': 'rflow',
               'use_timestep_transform': True},
 'seed': 42,
 'start_from_scratch': False,
 'vae': {'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/stabilityai/stable-diffusion-xl-base-1.0/vae',
         'micro_batch_size': 64,
         'micro_frame_size': 8,
         'type': 'SDXL'},
 'wandb': True,
 'warmup_steps': 1000}
[[34m2025-06-20 06:48:09[0m] Building dataset...
[[34m2025-06-20 06:48:09[0m] Dataset contains unknown number of samples.
[[34m2025-06-20 06:48:09[0m] Building models...
[[34m2025-06-20 06:48:24[0m] [Diffusion] Trainable model params: 1.12 B, Total model params: 1.13 B
[[34m2025-06-20 06:48:27[0m] mask ratios: {'video_obs_4_frame': 1.0, 'identity': 0.0}
[[34m2025-06-20 06:48:27[0m] Preparing for distributed training...
[[34m2025-06-20 06:48:27[0m] Boosting model for distributed training
[[34m2025-06-20 06:48:27[0m] Training for 10000 epochs with 1000000 steps per epoch
[[34m2025-06-20 06:48:27[0m] Beginning epoch 0...
[[34m2025-06-20 07:06:44[0m] Experiment directory created at /mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla_debug/007-STDiT3-XL-2
[[34m2025-06-20 07:06:44[0m] Training configuration:
 {'adam_eps': 1e-15,
 'batch_size': 4,
 'cache_pin_memory': False,
 'ckpt_every': 10000,
 'config': 'configs/libero/train/sdxl_simplevla_web_mix.py',
 'dataset': {'Ta': 8,
             'To': 4,
             'action_dim': 7,
             'episode_buf_size': 20,
             'episode_per_shard': 30,
             'image_size': (256, 256),
             'sample_buf_size': 1000,
             'shards_pattern1': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/webdataset_shards/06/17_mp/**/*.tar',
             'shards_pattern2': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/webdataset_shards/libero/libero_10_no_noops/**/*.tar',
             'stats_path': '/mnt/hdfs/zhufangqi/datasets/libero/dataset_statistics.json',
             'stride': 1,
             'type': 'MixedSimpleVLAWebDataset',
             'weights': [0.7, 0.3]},
 'dtype': 'bf16',
 'ema_decay': 0.99,
 'epochs': 10000,
 'grad_checkpoint': False,
 'grad_clip': 1.0,
 'load': None,
 'log_every': 10,
 'lr': 0.0001,
 'mask_ratios': {'video_obs_4_frame': 1.0},
 'model': {'action_dim': 7,
           'cfg': False,
           'enable_flash_attn': True,
           'enable_layernorm_kernel': True,
           'freeze_y_embedder': True,
           'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/hpcai-tech/OpenSora-STDiT-v3/model.safetensors',
           'pad_action_num': 4,
           'qk_norm': True,
           'skip_y_embedder': True,
           'training': True,
           'type': 'STDiT3-XL/2'},
 'num_workers': 4,
 'outputs': '/mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla_debug',
 'pin_memory_cache_pre_alloc_numels': [325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560],
 'plugin': 'zero2',
 'record_time': False,
 'scheduler': {'sample_method': 'logit-normal',
               'type': 'rflow',
               'use_timestep_transform': True},
 'seed': 42,
 'start_from_scratch': False,
 'vae': {'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/stabilityai/stable-diffusion-xl-base-1.0/vae',
         'micro_batch_size': 64,
         'micro_frame_size': 8,
         'type': 'SDXL'},
 'wandb': True,
 'warmup_steps': 1000}
[[34m2025-06-20 07:06:46[0m] Building dataset...
[[34m2025-06-20 07:06:46[0m] Dataset contains unknown number of samples.
[[34m2025-06-20 07:06:46[0m] Building models...
[[34m2025-06-20 07:08:35[0m] Experiment directory created at /mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla_debug/008-STDiT3-XL-2
[[34m2025-06-20 07:08:35[0m] Training configuration:
 {'adam_eps': 1e-15,
 'batch_size': 4,
 'cache_pin_memory': False,
 'ckpt_every': 10000,
 'config': 'configs/libero/train/sdxl_simplevla_web_mix.py',
 'dataset': {'Ta': 8,
             'To': 4,
             'action_dim': 7,
             'episode_buf_size': 20,
             'episode_per_shard': 30,
             'image_size': (256, 256),
             'sample_buf_size': 1000,
             'shards_pattern1': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/webdataset_shards/06/17_mp/**/*.tar',
             'shards_pattern2': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/webdataset_shards/libero/libero_10_no_noops/**/*.tar',
             'stats_path': '/mnt/hdfs/zhufangqi/datasets/libero/dataset_statistics.json',
             'stride': 1,
             'type': 'MixedSimpleVLAWebDataset',
             'weights': [0.7, 0.3]},
 'dtype': 'bf16',
 'ema_decay': 0.99,
 'epochs': 10000,
 'grad_checkpoint': False,
 'grad_clip': 1.0,
 'load': None,
 'log_every': 10,
 'lr': 0.0001,
 'mask_ratios': {'video_obs_4_frame': 1.0},
 'model': {'action_dim': 7,
           'cfg': False,
           'enable_flash_attn': True,
           'enable_layernorm_kernel': True,
           'freeze_y_embedder': True,
           'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/hpcai-tech/OpenSora-STDiT-v3/model.safetensors',
           'pad_action_num': 4,
           'qk_norm': True,
           'skip_y_embedder': True,
           'training': True,
           'type': 'STDiT3-XL/2'},
 'num_workers': 4,
 'outputs': '/mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla_debug',
 'pin_memory_cache_pre_alloc_numels': [325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560],
 'plugin': 'zero2',
 'record_time': False,
 'scheduler': {'sample_method': 'logit-normal',
               'type': 'rflow',
               'use_timestep_transform': True},
 'seed': 42,
 'start_from_scratch': False,
 'vae': {'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/stabilityai/stable-diffusion-xl-base-1.0/vae',
         'micro_batch_size': 64,
         'micro_frame_size': 8,
         'type': 'SDXL'},
 'wandb': True,
 'warmup_steps': 1000}
[[34m2025-06-20 07:08:37[0m] Building dataset...
[[34m2025-06-20 07:08:37[0m] Dataset contains unknown number of samples.
[[34m2025-06-20 07:08:37[0m] Building models...
[[34m2025-06-20 07:10:09[0m] Experiment directory created at /mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla_debug/009-STDiT3-XL-2
[[34m2025-06-20 07:10:09[0m] Training configuration:
 {'adam_eps': 1e-15,
 'batch_size': 4,
 'cache_pin_memory': False,
 'ckpt_every': 10000,
 'config': 'configs/libero/train/sdxl_simplevla_web_mix.py',
 'dataset': {'Ta': 8,
             'To': 4,
             'action_dim': 7,
             'episode_buf_size': 20,
             'episode_per_shard': 30,
             'image_size': (256, 256),
             'sample_buf_size': 1000,
             'shards_pattern1': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/webdataset_shards/06/17_mp/**/*.tar',
             'shards_pattern2': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/webdataset_shards/libero/libero_10_no_noops/**/*.tar',
             'stats_path': '/mnt/hdfs/zhufangqi/datasets/libero/dataset_statistics.json',
             'stride': 1,
             'type': 'MixedSimpleVLAWebDataset',
             'weights': [0.7, 0.3]},
 'dtype': 'bf16',
 'ema_decay': 0.99,
 'epochs': 10000,
 'grad_checkpoint': False,
 'grad_clip': 1.0,
 'load': None,
 'log_every': 10,
 'lr': 0.0001,
 'mask_ratios': {'video_obs_4_frame': 1.0},
 'model': {'action_dim': 7,
           'cfg': False,
           'enable_flash_attn': True,
           'enable_layernorm_kernel': True,
           'freeze_y_embedder': True,
           'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/hpcai-tech/OpenSora-STDiT-v3/model.safetensors',
           'pad_action_num': 4,
           'qk_norm': True,
           'skip_y_embedder': True,
           'training': True,
           'type': 'STDiT3-XL/2'},
 'num_workers': 4,
 'outputs': '/mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla_debug',
 'pin_memory_cache_pre_alloc_numels': [325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560],
 'plugin': 'zero2',
 'record_time': False,
 'scheduler': {'sample_method': 'logit-normal',
               'type': 'rflow',
               'use_timestep_transform': True},
 'seed': 42,
 'start_from_scratch': False,
 'vae': {'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/stabilityai/stable-diffusion-xl-base-1.0/vae',
         'micro_batch_size': 64,
         'micro_frame_size': 8,
         'type': 'SDXL'},
 'wandb': True,
 'warmup_steps': 1000}
[[34m2025-06-20 07:10:10[0m] Building dataset...
[[34m2025-06-20 07:10:10[0m] Dataset contains unknown number of samples.
[[34m2025-06-20 07:10:10[0m] Building models...
[[34m2025-06-20 07:10:25[0m] [Diffusion] Trainable model params: 1.12 B, Total model params: 1.13 B
[[34m2025-06-20 07:10:28[0m] mask ratios: {'video_obs_4_frame': 1.0, 'identity': 0.0}
[[34m2025-06-20 07:10:28[0m] Preparing for distributed training...
[[34m2025-06-20 07:10:28[0m] Boosting model for distributed training
[[34m2025-06-20 07:10:28[0m] Training for 10000 epochs with 1000000 steps per epoch
[[34m2025-06-20 07:10:28[0m] Beginning epoch 0...
[[34m2025-06-20 07:18:41[0m] Experiment directory created at /mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla_debug/010-STDiT3-XL-2
[[34m2025-06-20 07:18:41[0m] Training configuration:
 {'adam_eps': 1e-15,
 'batch_size': 4,
 'cache_pin_memory': False,
 'ckpt_every': 10000,
 'config': 'configs/libero/train/sdxl_simplevla_web_mix.py',
 'dataset': {'Ta': 8,
             'To': 4,
             'action_dim': 7,
             'episode_buf_size': 20,
             'episode_per_shard': 30,
             'image_size': (256, 256),
             'sample_buf_size': 1000,
             'shards_pattern1': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/webdataset_shards/06/17_mp/**/*.tar',
             'shards_pattern2': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/webdataset_shards/libero/libero_10_no_noops/**/*.tar',
             'stats_path': '/mnt/hdfs/zhufangqi/datasets/libero/dataset_statistics.json',
             'stride': 1,
             'type': 'MixedSimpleVLAWebDataset',
             'weights': [0.7, 0.3]},
 'dtype': 'bf16',
 'ema_decay': 0.99,
 'epochs': 10000,
 'grad_checkpoint': False,
 'grad_clip': 1.0,
 'load': None,
 'log_every': 10,
 'lr': 0.0001,
 'mask_ratios': {'video_obs_4_frame': 1.0},
 'model': {'action_dim': 7,
           'cfg': False,
           'enable_flash_attn': True,
           'enable_layernorm_kernel': True,
           'freeze_y_embedder': True,
           'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/hpcai-tech/OpenSora-STDiT-v3/model.safetensors',
           'pad_action_num': 4,
           'qk_norm': True,
           'skip_y_embedder': True,
           'training': True,
           'type': 'STDiT3-XL/2'},
 'num_workers': 4,
 'outputs': '/mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla_debug',
 'pin_memory_cache_pre_alloc_numels': [325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560],
 'plugin': 'zero2',
 'record_time': False,
 'scheduler': {'sample_method': 'logit-normal',
               'type': 'rflow',
               'use_timestep_transform': True},
 'seed': 42,
 'start_from_scratch': False,
 'vae': {'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/stabilityai/stable-diffusion-xl-base-1.0/vae',
         'micro_batch_size': 64,
         'micro_frame_size': 8,
         'type': 'SDXL'},
 'wandb': True,
 'warmup_steps': 1000}
[[34m2025-06-20 07:18:43[0m] Building dataset...
[[34m2025-06-20 07:19:44[0m] Experiment directory created at /mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla_debug/011-STDiT3-XL-2
[[34m2025-06-20 07:19:44[0m] Training configuration:
 {'adam_eps': 1e-15,
 'batch_size': 4,
 'cache_pin_memory': False,
 'ckpt_every': 10000,
 'config': 'configs/libero/train/sdxl_simplevla_web_mix.py',
 'dataset': {'Ta': 8,
             'To': 4,
             'action_dim': 7,
             'episode_buf_size': 20,
             'episode_per_shard': 30,
             'image_size': (256, 256),
             'sample_buf_size': 1000,
             'shards_pattern1': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/webdataset_shards/06/17_mp/**/*.tar',
             'shards_pattern2': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/webdataset_shards/libero/libero_10_no_noops/**/*.tar',
             'stats_path': '/mnt/hdfs/zhufangqi/datasets/libero/dataset_statistics.json',
             'stride': 1,
             'type': 'MixedSimpleVLAWebDataset',
             'weights': [0.7, 0.3]},
 'dtype': 'bf16',
 'ema_decay': 0.99,
 'epochs': 10000,
 'grad_checkpoint': False,
 'grad_clip': 1.0,
 'load': None,
 'log_every': 10,
 'lr': 0.0001,
 'mask_ratios': {'video_obs_4_frame': 1.0},
 'model': {'action_dim': 7,
           'cfg': False,
           'enable_flash_attn': True,
           'enable_layernorm_kernel': True,
           'freeze_y_embedder': True,
           'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/hpcai-tech/OpenSora-STDiT-v3/model.safetensors',
           'pad_action_num': 4,
           'qk_norm': True,
           'skip_y_embedder': True,
           'training': True,
           'type': 'STDiT3-XL/2'},
 'num_workers': 4,
 'outputs': '/mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla_debug',
 'pin_memory_cache_pre_alloc_numels': [325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560],
 'plugin': 'zero2',
 'record_time': False,
 'scheduler': {'sample_method': 'logit-normal',
               'type': 'rflow',
               'use_timestep_transform': True},
 'seed': 42,
 'start_from_scratch': False,
 'vae': {'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/stabilityai/stable-diffusion-xl-base-1.0/vae',
         'micro_batch_size': 64,
         'micro_frame_size': 8,
         'type': 'SDXL'},
 'wandb': True,
 'warmup_steps': 1000}
[[34m2025-06-20 07:19:46[0m] Building dataset...
[[34m2025-06-20 07:19:46[0m] Dataset contains unknown number of samples.
[[34m2025-06-20 07:19:46[0m] Building models...
[[34m2025-06-20 07:20:00[0m] [Diffusion] Trainable model params: 1.12 B, Total model params: 1.13 B
[[34m2025-06-20 07:20:03[0m] mask ratios: {'video_obs_4_frame': 1.0, 'identity': 0.0}
[[34m2025-06-20 07:20:03[0m] Preparing for distributed training...
[[34m2025-06-20 07:20:03[0m] Boosting model for distributed training
[[34m2025-06-20 07:20:03[0m] Training for 10000 epochs with 1000000 steps per epoch
[[34m2025-06-20 07:20:04[0m] Beginning epoch 0...
[[34m2025-06-20 07:24:50[0m] Experiment directory created at /mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla_debug/012-STDiT3-XL-2
[[34m2025-06-20 07:24:50[0m] Training configuration:
 {'adam_eps': 1e-15,
 'batch_size': 4,
 'cache_pin_memory': False,
 'ckpt_every': 10000,
 'config': 'configs/libero/train/sdxl_simplevla_web_mix.py',
 'dataset': {'Ta': 8,
             'To': 4,
             'action_dim': 7,
             'episode_buf_size': 20,
             'episode_per_shard': 30,
             'image_size': (256, 256),
             'sample_buf_size': 1000,
             'shards_pattern1': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/webdataset_shards/06/17_mp/**/*.tar',
             'shards_pattern2': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/webdataset_shards/libero/libero_10_no_noops/**/*.tar',
             'stats_path': '/mnt/hdfs/zhufangqi/datasets/libero/dataset_statistics.json',
             'stride': 1,
             'type': 'MixedSimpleVLAWebDataset',
             'weights': [0.7, 0.3]},
 'dtype': 'bf16',
 'ema_decay': 0.99,
 'epochs': 10000,
 'grad_checkpoint': False,
 'grad_clip': 1.0,
 'load': None,
 'log_every': 10,
 'lr': 0.0001,
 'mask_ratios': {'video_obs_4_frame': 1.0},
 'model': {'action_dim': 7,
           'cfg': False,
           'enable_flash_attn': True,
           'enable_layernorm_kernel': True,
           'freeze_y_embedder': True,
           'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/hpcai-tech/OpenSora-STDiT-v3/model.safetensors',
           'pad_action_num': 4,
           'qk_norm': True,
           'skip_y_embedder': True,
           'training': True,
           'type': 'STDiT3-XL/2'},
 'num_workers': 4,
 'outputs': '/mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla_debug',
 'pin_memory_cache_pre_alloc_numels': [325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560],
 'plugin': 'zero2',
 'record_time': False,
 'scheduler': {'sample_method': 'logit-normal',
               'type': 'rflow',
               'use_timestep_transform': True},
 'seed': 42,
 'start_from_scratch': False,
 'vae': {'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/stabilityai/stable-diffusion-xl-base-1.0/vae',
         'micro_batch_size': 64,
         'micro_frame_size': 8,
         'type': 'SDXL'},
 'wandb': True,
 'warmup_steps': 1000}
[[34m2025-06-20 07:24:52[0m] Building dataset...
[[34m2025-06-20 07:24:52[0m] Dataset contains unknown number of samples.
[[34m2025-06-20 07:24:52[0m] Building models...
[[34m2025-06-20 07:25:07[0m] [Diffusion] Trainable model params: 1.12 B, Total model params: 1.13 B
[[34m2025-06-20 07:25:10[0m] mask ratios: {'video_obs_4_frame': 1.0, 'identity': 0.0}
[[34m2025-06-20 07:25:10[0m] Preparing for distributed training...
[[34m2025-06-20 07:25:10[0m] Boosting model for distributed training
[[34m2025-06-20 07:25:10[0m] Training for 10000 epochs with 1000000 steps per epoch
[[34m2025-06-20 07:25:10[0m] Beginning epoch 0...
[[34m2025-06-20 07:27:51[0m] Experiment directory created at /mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla_debug/013-STDiT3-XL-2
[[34m2025-06-20 07:27:51[0m] Training configuration:
 {'adam_eps': 1e-15,
 'batch_size': 4,
 'cache_pin_memory': False,
 'ckpt_every': 10000,
 'config': 'configs/libero/train/sdxl_simplevla_web_mix.py',
 'dataset': {'Ta': 8,
             'To': 4,
             'action_dim': 7,
             'episode_buf_size': 10,
             'episode_per_shard': 30,
             'image_size': (256, 256),
             'sample_buf_size': 1000,
             'shards_pattern1': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/webdataset_shards/06/17_mp/**/*.tar',
             'shards_pattern2': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/webdataset_shards/libero/libero_10_no_noops/**/*.tar',
             'stats_path': '/mnt/hdfs/zhufangqi/datasets/libero/dataset_statistics.json',
             'stride': 1,
             'type': 'MixedSimpleVLAWebDataset',
             'weights': [0.7, 0.3]},
 'dtype': 'bf16',
 'ema_decay': 0.99,
 'epochs': 10000,
 'grad_checkpoint': False,
 'grad_clip': 1.0,
 'load': None,
 'log_every': 10,
 'lr': 0.0001,
 'mask_ratios': {'video_obs_4_frame': 1.0},
 'model': {'action_dim': 7,
           'cfg': False,
           'enable_flash_attn': True,
           'enable_layernorm_kernel': True,
           'freeze_y_embedder': True,
           'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/hpcai-tech/OpenSora-STDiT-v3/model.safetensors',
           'pad_action_num': 4,
           'qk_norm': True,
           'skip_y_embedder': True,
           'training': True,
           'type': 'STDiT3-XL/2'},
 'num_workers': 4,
 'outputs': '/mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla_debug',
 'pin_memory_cache_pre_alloc_numels': [325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560],
 'plugin': 'zero2',
 'record_time': False,
 'scheduler': {'sample_method': 'logit-normal',
               'type': 'rflow',
               'use_timestep_transform': True},
 'seed': 42,
 'start_from_scratch': False,
 'vae': {'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/stabilityai/stable-diffusion-xl-base-1.0/vae',
         'micro_batch_size': 64,
         'micro_frame_size': 8,
         'type': 'SDXL'},
 'wandb': True,
 'warmup_steps': 1000}
[[34m2025-06-20 07:27:53[0m] Building dataset...
[[34m2025-06-20 07:27:53[0m] Dataset contains unknown number of samples.
[[34m2025-06-20 07:27:53[0m] Building models...
[[34m2025-06-20 07:28:07[0m] [Diffusion] Trainable model params: 1.12 B, Total model params: 1.13 B
[[34m2025-06-20 07:28:10[0m] mask ratios: {'video_obs_4_frame': 1.0, 'identity': 0.0}
[[34m2025-06-20 07:28:10[0m] Preparing for distributed training...
[[34m2025-06-20 07:28:10[0m] Boosting model for distributed training
[[34m2025-06-20 07:28:10[0m] Training for 10000 epochs with 1000000 steps per epoch
[[34m2025-06-20 07:28:11[0m] Beginning epoch 0...
[[34m2025-06-20 07:29:33[0m] Experiment directory created at /mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla_debug/014-STDiT3-XL-2
[[34m2025-06-20 07:29:33[0m] Training configuration:
 {'adam_eps': 1e-15,
 'batch_size': 4,
 'cache_pin_memory': False,
 'ckpt_every': 10000,
 'config': 'configs/libero/train/sdxl_simplevla_web_mix.py',
 'dataset': {'Ta': 8,
             'To': 4,
             'action_dim': 7,
             'episode_buf_size': 20,
             'episode_per_shard': 30,
             'image_size': (256, 256),
             'sample_buf_size': 2000,
             'shards_pattern1': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/webdataset_shards/06/17_mp/**/*.tar',
             'shards_pattern2': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/webdataset_shards/libero/libero_10_no_noops/**/*.tar',
             'stats_path': '/mnt/hdfs/zhufangqi/datasets/libero/dataset_statistics.json',
             'stride': 1,
             'type': 'MixedSimpleVLAWebDataset',
             'weights': [0.7, 0.3]},
 'dtype': 'bf16',
 'ema_decay': 0.99,
 'epochs': 10000,
 'grad_checkpoint': False,
 'grad_clip': 1.0,
 'load': None,
 'log_every': 10,
 'lr': 0.0001,
 'mask_ratios': {'video_obs_4_frame': 1.0},
 'model': {'action_dim': 7,
           'cfg': False,
           'enable_flash_attn': True,
           'enable_layernorm_kernel': True,
           'freeze_y_embedder': True,
           'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/hpcai-tech/OpenSora-STDiT-v3/model.safetensors',
           'pad_action_num': 4,
           'qk_norm': True,
           'skip_y_embedder': True,
           'training': True,
           'type': 'STDiT3-XL/2'},
 'num_workers': 4,
 'outputs': '/mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla_debug',
 'pin_memory_cache_pre_alloc_numels': [325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560],
 'plugin': 'zero2',
 'record_time': False,
 'scheduler': {'sample_method': 'logit-normal',
               'type': 'rflow',
               'use_timestep_transform': True},
 'seed': 42,
 'start_from_scratch': False,
 'vae': {'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/stabilityai/stable-diffusion-xl-base-1.0/vae',
         'micro_batch_size': 64,
         'micro_frame_size': 8,
         'type': 'SDXL'},
 'wandb': True,
 'warmup_steps': 1000}
[[34m2025-06-20 07:29:34[0m] Building dataset...
[[34m2025-06-20 07:29:34[0m] Dataset contains unknown number of samples.
[[34m2025-06-20 07:29:34[0m] Building models...
[[34m2025-06-20 07:29:49[0m] [Diffusion] Trainable model params: 1.12 B, Total model params: 1.13 B
[[34m2025-06-20 07:29:52[0m] mask ratios: {'video_obs_4_frame': 1.0, 'identity': 0.0}
[[34m2025-06-20 07:29:52[0m] Preparing for distributed training...
[[34m2025-06-20 07:29:52[0m] Boosting model for distributed training
[[34m2025-06-20 07:29:52[0m] Training for 10000 epochs with 1000000 steps per epoch
[[34m2025-06-20 07:29:52[0m] Beginning epoch 0...
[[34m2025-06-20 07:34:16[0m] Experiment directory created at /mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla_debug/015-STDiT3-XL-2
[[34m2025-06-20 07:34:16[0m] Training configuration:
 {'adam_eps': 1e-15,
 'batch_size': 4,
 'cache_pin_memory': False,
 'ckpt_every': 10000,
 'config': 'configs/libero/train/sdxl_simplevla_web_mix.py',
 'dataset': {'Ta': 8,
             'To': 4,
             'action_dim': 7,
             'episode_buf_size': 30,
             'episode_per_shard': 30,
             'image_size': (256, 256),
             'sample_buf_size': 2000,
             'shards_pattern1': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/webdataset_shards/06/17_mp/**/*.tar',
             'shards_pattern2': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/webdataset_shards/libero/libero_10_no_noops/**/*.tar',
             'stats_path': '/mnt/hdfs/zhufangqi/datasets/libero/dataset_statistics.json',
             'stride': 1,
             'type': 'MixedSimpleVLAWebDataset',
             'weights': [0.7, 0.3]},
 'dtype': 'bf16',
 'ema_decay': 0.99,
 'epochs': 10000,
 'grad_checkpoint': False,
 'grad_clip': 1.0,
 'load': None,
 'log_every': 10,
 'lr': 0.0001,
 'mask_ratios': {'video_obs_4_frame': 1.0},
 'model': {'action_dim': 7,
           'cfg': False,
           'enable_flash_attn': True,
           'enable_layernorm_kernel': True,
           'freeze_y_embedder': True,
           'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/hpcai-tech/OpenSora-STDiT-v3/model.safetensors',
           'pad_action_num': 4,
           'qk_norm': True,
           'skip_y_embedder': True,
           'training': True,
           'type': 'STDiT3-XL/2'},
 'num_workers': 4,
 'outputs': '/mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla_debug',
 'pin_memory_cache_pre_alloc_numels': [325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560],
 'plugin': 'zero2',
 'record_time': False,
 'scheduler': {'sample_method': 'logit-normal',
               'type': 'rflow',
               'use_timestep_transform': True},
 'seed': 42,
 'start_from_scratch': False,
 'vae': {'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/stabilityai/stable-diffusion-xl-base-1.0/vae',
         'micro_batch_size': 64,
         'micro_frame_size': 8,
         'type': 'SDXL'},
 'wandb': True,
 'warmup_steps': 1000}
[[34m2025-06-20 07:34:18[0m] Building dataset...
[[34m2025-06-20 07:34:18[0m] Dataset contains unknown number of samples.
[[34m2025-06-20 07:34:18[0m] Building models...
[[34m2025-06-20 07:34:46[0m] [Diffusion] Trainable model params: 1.12 B, Total model params: 1.13 B
[[34m2025-06-20 07:34:50[0m] mask ratios: {'video_obs_4_frame': 1.0, 'identity': 0.0}
[[34m2025-06-20 07:34:50[0m] Preparing for distributed training...
[[34m2025-06-20 07:34:50[0m] Boosting model for distributed training
[[34m2025-06-20 07:34:50[0m] Training for 10000 epochs with 1000000 steps per epoch
[[34m2025-06-20 07:34:51[0m] Beginning epoch 0...
[[34m2025-06-20 07:43:12[0m] Experiment directory created at /mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla_debug/016-STDiT3-XL-2
[[34m2025-06-20 07:43:12[0m] Training configuration:
 {'adam_eps': 1e-15,
 'batch_size': 4,
 'cache_pin_memory': False,
 'ckpt_every': 10000,
 'config': 'configs/libero/train/sdxl_simplevla_web_mix.py',
 'dataset': {'Ta': 8,
             'To': 4,
             'action_dim': 7,
             'episode_buf_size': 30,
             'episode_per_shard': 30,
             'image_size': (256, 256),
             'sample_buf_size': 2000,
             'shards_pattern1': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/webdataset_shards/06/17_mp/**/*.tar',
             'shards_pattern2': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/webdataset_shards/libero/libero_10_no_noops/**/*.tar',
             'stats_path': '/mnt/hdfs/zhufangqi/datasets/libero/dataset_statistics.json',
             'stride': 1,
             'type': 'MixedSimpleVLAWebDataset',
             'weights': [0.7, 0.3]},
 'dtype': 'bf16',
 'ema_decay': 0.99,
 'epochs': 10000,
 'grad_checkpoint': False,
 'grad_clip': 1.0,
 'load': None,
 'log_every': 10,
 'lr': 0.0001,
 'mask_ratios': {'video_obs_4_frame': 1.0},
 'model': {'action_dim': 7,
           'cfg': False,
           'enable_flash_attn': True,
           'enable_layernorm_kernel': True,
           'freeze_y_embedder': True,
           'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/hpcai-tech/OpenSora-STDiT-v3/model.safetensors',
           'pad_action_num': 4,
           'qk_norm': True,
           'skip_y_embedder': True,
           'training': True,
           'type': 'STDiT3-XL/2'},
 'num_workers': 4,
 'outputs': '/mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla_debug',
 'pin_memory_cache_pre_alloc_numels': [325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560],
 'plugin': 'zero2',
 'record_time': False,
 'scheduler': {'sample_method': 'logit-normal',
               'type': 'rflow',
               'use_timestep_transform': True},
 'seed': 42,
 'start_from_scratch': False,
 'vae': {'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/stabilityai/stable-diffusion-xl-base-1.0/vae',
         'micro_batch_size': 64,
         'micro_frame_size': 8,
         'type': 'SDXL'},
 'wandb': True,
 'warmup_steps': 1000}
[[34m2025-06-20 07:43:14[0m] Building dataset...
[[34m2025-06-20 07:43:14[0m] Dataset contains unknown number of samples.
[[34m2025-06-20 07:43:14[0m] Building models...
[[34m2025-06-20 07:43:29[0m] [Diffusion] Trainable model params: 1.12 B, Total model params: 1.13 B
[[34m2025-06-20 07:43:32[0m] mask ratios: {'video_obs_4_frame': 1.0, 'identity': 0.0}
[[34m2025-06-20 07:43:32[0m] Preparing for distributed training...
[[34m2025-06-20 07:43:32[0m] Boosting model for distributed training
[[34m2025-06-20 07:43:32[0m] Training for 10000 epochs with 1000000 steps per epoch
[[34m2025-06-20 07:43:32[0m] Beginning epoch 0...
[[34m2025-06-20 07:46:42[0m] Experiment directory created at /mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla_debug/017-STDiT3-XL-2
[[34m2025-06-20 07:46:42[0m] Training configuration:
 {'adam_eps': 1e-15,
 'batch_size': 4,
 'cache_pin_memory': False,
 'ckpt_every': 10000,
 'config': 'configs/libero/train/sdxl_simplevla_web_mix.py',
 'dataset': {'Ta': 8,
             'To': 4,
             'action_dim': 7,
             'episode_buf_size': 10,
             'episode_per_shard': 30,
             'image_size': (256, 256),
             'sample_buf_size': 1000,
             'shards_pattern1': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/webdataset_shards/06/17_mp/**/*.tar',
             'shards_pattern2': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/webdataset_shards/libero/libero_10_no_noops/**/*.tar',
             'stats_path': '/mnt/hdfs/zhufangqi/datasets/libero/dataset_statistics.json',
             'stride': 1,
             'type': 'MixedSimpleVLAWebDataset',
             'weights': [0.7, 0.3]},
 'dtype': 'bf16',
 'ema_decay': 0.99,
 'epochs': 10000,
 'grad_checkpoint': False,
 'grad_clip': 1.0,
 'load': None,
 'log_every': 10,
 'lr': 0.0001,
 'mask_ratios': {'video_obs_4_frame': 1.0},
 'model': {'action_dim': 7,
           'cfg': False,
           'enable_flash_attn': True,
           'enable_layernorm_kernel': True,
           'freeze_y_embedder': True,
           'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/hpcai-tech/OpenSora-STDiT-v3/model.safetensors',
           'pad_action_num': 4,
           'qk_norm': True,
           'skip_y_embedder': True,
           'training': True,
           'type': 'STDiT3-XL/2'},
 'num_workers': 4,
 'outputs': '/mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla_debug',
 'pin_memory_cache_pre_alloc_numels': [325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560],
 'plugin': 'zero2',
 'record_time': False,
 'scheduler': {'sample_method': 'logit-normal',
               'type': 'rflow',
               'use_timestep_transform': True},
 'seed': 42,
 'start_from_scratch': False,
 'vae': {'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/stabilityai/stable-diffusion-xl-base-1.0/vae',
         'micro_batch_size': 64,
         'micro_frame_size': 8,
         'type': 'SDXL'},
 'wandb': True,
 'warmup_steps': 1000}
[[34m2025-06-20 07:46:44[0m] Building dataset...
[[34m2025-06-20 07:46:44[0m] Dataset contains unknown number of samples.
[[34m2025-06-20 07:46:44[0m] Building models...
[[34m2025-06-20 07:47:16[0m] [Diffusion] Trainable model params: 1.12 B, Total model params: 1.13 B
[[34m2025-06-20 07:47:19[0m] mask ratios: {'video_obs_4_frame': 1.0, 'identity': 0.0}
[[34m2025-06-20 07:47:19[0m] Preparing for distributed training...
[[34m2025-06-20 07:47:19[0m] Boosting model for distributed training
[[34m2025-06-20 07:47:19[0m] Training for 10000 epochs with 1000000 steps per epoch
[[34m2025-06-20 07:47:19[0m] Beginning epoch 0...
[[34m2025-06-20 08:01:37[0m] Experiment directory created at /mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla_debug/018-STDiT3-XL-2
[[34m2025-06-20 08:01:37[0m] Training configuration:
 {'adam_eps': 1e-15,
 'batch_size': 4,
 'cache_pin_memory': False,
 'ckpt_every': 10000,
 'config': 'configs/libero/train/sdxl_simplevla_web_mix.py',
 'dataset': {'Ta': 8,
             'To': 4,
             'action_dim': 7,
             'episode_buf_size': 10,
             'episode_per_shard': 30,
             'image_size': (256, 256),
             'sample_buf_size': 1000,
             'shards_pattern1': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/webdataset_shards/06/16_mp/**/*.tar',
             'shards_pattern2': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/webdataset_shards/libero/libero_10_no_noops/**/*.tar',
             'stats_path': '/mnt/hdfs/zhufangqi/datasets/libero/dataset_statistics.json',
             'stride': 1,
             'type': 'MixedSimpleVLAWebDataset',
             'weights': [0.7, 0.3]},
 'dtype': 'bf16',
 'ema_decay': 0.99,
 'epochs': 10000,
 'grad_checkpoint': False,
 'grad_clip': 1.0,
 'load': None,
 'log_every': 10,
 'lr': 0.0001,
 'mask_ratios': {'video_obs_4_frame': 1.0},
 'model': {'action_dim': 7,
           'cfg': False,
           'enable_flash_attn': True,
           'enable_layernorm_kernel': True,
           'freeze_y_embedder': True,
           'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/hpcai-tech/OpenSora-STDiT-v3/model.safetensors',
           'pad_action_num': 4,
           'qk_norm': True,
           'skip_y_embedder': True,
           'training': True,
           'type': 'STDiT3-XL/2'},
 'num_workers': 2,
 'outputs': '/mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla_debug',
 'pin_memory_cache_pre_alloc_numels': [325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560],
 'plugin': 'zero2',
 'record_time': False,
 'scheduler': {'sample_method': 'logit-normal',
               'type': 'rflow',
               'use_timestep_transform': True},
 'seed': 42,
 'start_from_scratch': False,
 'vae': {'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/stabilityai/stable-diffusion-xl-base-1.0/vae',
         'micro_batch_size': 64,
         'micro_frame_size': 8,
         'type': 'SDXL'},
 'wandb': True,
 'warmup_steps': 1000}
[[34m2025-06-20 08:01:38[0m] Building dataset...
[[34m2025-06-20 08:01:38[0m] Dataset contains unknown number of samples.
[[34m2025-06-20 08:01:38[0m] Building models...
[[34m2025-06-20 08:01:53[0m] [Diffusion] Trainable model params: 1.12 B, Total model params: 1.13 B
[[34m2025-06-20 08:01:56[0m] mask ratios: {'video_obs_4_frame': 1.0, 'identity': 0.0}
[[34m2025-06-20 08:01:56[0m] Preparing for distributed training...
[[34m2025-06-20 08:01:56[0m] Boosting model for distributed training
[[34m2025-06-20 08:01:56[0m] Training for 10000 epochs with 1000000 steps per epoch
[[34m2025-06-20 08:01:56[0m] Beginning epoch 0...
[[34m2025-06-20 08:05:06[0m] Experiment directory created at /mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla_debug/019-STDiT3-XL-2
[[34m2025-06-20 08:05:06[0m] Training configuration:
 {'adam_eps': 1e-15,
 'batch_size': 4,
 'cache_pin_memory': False,
 'ckpt_every': 10000,
 'config': 'configs/libero/train/sdxl_simplevla_web_mix.py',
 'dataset': {'Ta': 8,
             'To': 4,
             'action_dim': 7,
             'episode_buf_size': 10,
             'episode_per_shard': 30,
             'image_size': (256, 256),
             'sample_buf_size': 1000,
             'shards_pattern1': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/webdataset_shards/06/16_mp/**/*.tar',
             'shards_pattern2': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/webdataset_shards/libero/libero_10_no_noops/**/*.tar',
             'stats_path': '/mnt/hdfs/zhufangqi/datasets/libero/dataset_statistics.json',
             'stride': 1,
             'type': 'MixedSimpleVLAWebDataset',
             'weights': [0.7, 0.3]},
 'dtype': 'bf16',
 'ema_decay': 0.99,
 'epochs': 10000,
 'grad_checkpoint': False,
 'grad_clip': 1.0,
 'load': None,
 'log_every': 10,
 'lr': 0.0001,
 'mask_ratios': {'video_obs_4_frame': 1.0},
 'model': {'action_dim': 7,
           'cfg': False,
           'enable_flash_attn': True,
           'enable_layernorm_kernel': True,
           'freeze_y_embedder': True,
           'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/hpcai-tech/OpenSora-STDiT-v3/model.safetensors',
           'pad_action_num': 4,
           'qk_norm': True,
           'skip_y_embedder': True,
           'training': True,
           'type': 'STDiT3-XL/2'},
 'num_workers': 2,
 'outputs': '/mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla_debug',
 'pin_memory_cache_pre_alloc_numels': [325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560],
 'plugin': 'zero2',
 'record_time': False,
 'scheduler': {'sample_method': 'logit-normal',
               'type': 'rflow',
               'use_timestep_transform': True},
 'seed': 42,
 'start_from_scratch': False,
 'vae': {'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/stabilityai/stable-diffusion-xl-base-1.0/vae',
         'micro_batch_size': 64,
         'micro_frame_size': 8,
         'type': 'SDXL'},
 'wandb': True,
 'warmup_steps': 1000}
[[34m2025-06-20 08:05:08[0m] Building dataset...
[[34m2025-06-20 08:05:08[0m] Dataset contains unknown number of samples.
[[34m2025-06-20 08:05:08[0m] Building models...
[[34m2025-06-20 08:05:23[0m] [Diffusion] Trainable model params: 1.12 B, Total model params: 1.13 B
[[34m2025-06-20 08:05:26[0m] mask ratios: {'video_obs_4_frame': 1.0, 'identity': 0.0}
[[34m2025-06-20 08:05:26[0m] Preparing for distributed training...
[[34m2025-06-20 08:05:26[0m] Boosting model for distributed training
[[34m2025-06-20 08:05:26[0m] Training for 10000 epochs with 1000000 steps per epoch
[[34m2025-06-20 08:05:27[0m] Beginning epoch 0...
[[34m2025-06-20 08:06:54[0m] Experiment directory created at /mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla_debug/020-STDiT3-XL-2
[[34m2025-06-20 08:06:54[0m] Training configuration:
 {'adam_eps': 1e-15,
 'batch_size': 4,
 'cache_pin_memory': False,
 'ckpt_every': 10000,
 'config': 'configs/libero/train/sdxl_simplevla_web_mix.py',
 'dataset': {'Ta': 8,
             'To': 4,
             'action_dim': 7,
             'episode_buf_size': 10,
             'episode_per_shard': 30,
             'image_size': (256, 256),
             'sample_buf_size': 1000,
             'shards_pattern1': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/webdataset_shards/06/16_mp/**/*.tar',
             'shards_pattern2': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/webdataset_shards/libero/libero_10_no_noops/**/*.tar',
             'stats_path': '/mnt/hdfs/zhufangqi/datasets/libero/dataset_statistics.json',
             'stride': 1,
             'type': 'MixedSimpleVLAWebDataset',
             'weights': [0.7, 0.3]},
 'dtype': 'bf16',
 'ema_decay': 0.99,
 'epochs': 10000,
 'grad_checkpoint': False,
 'grad_clip': 1.0,
 'load': None,
 'log_every': 10,
 'lr': 0.0001,
 'mask_ratios': {'video_obs_4_frame': 1.0},
 'model': {'action_dim': 7,
           'cfg': False,
           'enable_flash_attn': True,
           'enable_layernorm_kernel': True,
           'freeze_y_embedder': True,
           'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/hpcai-tech/OpenSora-STDiT-v3/model.safetensors',
           'pad_action_num': 4,
           'qk_norm': True,
           'skip_y_embedder': True,
           'training': True,
           'type': 'STDiT3-XL/2'},
 'num_workers': 2,
 'outputs': '/mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla_debug',
 'pin_memory_cache_pre_alloc_numels': [325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560],
 'plugin': 'zero2',
 'record_time': False,
 'scheduler': {'sample_method': 'logit-normal',
               'type': 'rflow',
               'use_timestep_transform': True},
 'seed': 42,
 'start_from_scratch': False,
 'vae': {'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/stabilityai/stable-diffusion-xl-base-1.0/vae',
         'micro_batch_size': 64,
         'micro_frame_size': 8,
         'type': 'SDXL'},
 'wandb': True,
 'warmup_steps': 1000}
[[34m2025-06-20 08:06:56[0m] Building dataset...
[[34m2025-06-20 08:06:56[0m] Dataset contains unknown number of samples.
[[34m2025-06-20 08:06:56[0m] Building models...
[[34m2025-06-20 08:07:11[0m] [Diffusion] Trainable model params: 1.12 B, Total model params: 1.13 B
[[34m2025-06-20 08:07:14[0m] mask ratios: {'video_obs_4_frame': 1.0, 'identity': 0.0}
[[34m2025-06-20 08:07:14[0m] Preparing for distributed training...
[[34m2025-06-20 08:07:14[0m] Boosting model for distributed training
[[34m2025-06-20 08:07:14[0m] Training for 10000 epochs with 1000000 steps per epoch
[[34m2025-06-20 08:07:14[0m] Beginning epoch 0...
[[34m2025-06-20 08:14:00[0m] Experiment directory created at /mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla_debug/021-STDiT3-XL-2
[[34m2025-06-20 08:14:00[0m] Training configuration:
 {'adam_eps': 1e-15,
 'batch_size': 4,
 'cache_pin_memory': False,
 'ckpt_every': 10000,
 'config': 'configs/libero/train/sdxl_simplevla_web_mix.py',
 'dataset': {'Ta': 8,
             'To': 4,
             'action_dim': 7,
             'episode_buf_size': 10,
             'episode_per_shard': 30,
             'image_size': (256, 256),
             'sample_buf_size': 1000,
             'shards_pattern1': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/webdataset_shards/06/16_mp/**/*.tar',
             'shards_pattern2': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/webdataset_shards/libero/libero_10_no_noops/**/*.tar',
             'stats_path': '/mnt/hdfs/zhufangqi/datasets/libero/dataset_statistics.json',
             'stride': 1,
             'type': 'MixedSimpleVLAWebDataset',
             'weights': [0.7, 0.3]},
 'dtype': 'bf16',
 'ema_decay': 0.99,
 'epochs': 10000,
 'grad_checkpoint': False,
 'grad_clip': 1.0,
 'load': None,
 'log_every': 10,
 'lr': 0.0001,
 'mask_ratios': {'video_obs_4_frame': 1.0},
 'model': {'action_dim': 7,
           'cfg': False,
           'enable_flash_attn': True,
           'enable_layernorm_kernel': True,
           'freeze_y_embedder': True,
           'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/hpcai-tech/OpenSora-STDiT-v3/model.safetensors',
           'pad_action_num': 4,
           'qk_norm': True,
           'skip_y_embedder': True,
           'training': True,
           'type': 'STDiT3-XL/2'},
 'num_workers': 2,
 'outputs': '/mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla_debug',
 'pin_memory_cache_pre_alloc_numels': [325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560],
 'plugin': 'zero2',
 'record_time': False,
 'scheduler': {'sample_method': 'logit-normal',
               'type': 'rflow',
               'use_timestep_transform': True},
 'seed': 42,
 'start_from_scratch': False,
 'vae': {'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/stabilityai/stable-diffusion-xl-base-1.0/vae',
         'micro_batch_size': 64,
         'micro_frame_size': 8,
         'type': 'SDXL'},
 'wandb': True,
 'warmup_steps': 1000}
[[34m2025-06-20 08:14:02[0m] Building dataset...
[[34m2025-06-20 08:14:02[0m] Dataset contains unknown number of samples.
[[34m2025-06-20 08:14:02[0m] Building models...
[[34m2025-06-20 08:14:18[0m] [Diffusion] Trainable model params: 1.12 B, Total model params: 1.13 B
[[34m2025-06-20 08:14:22[0m] mask ratios: {'video_obs_4_frame': 1.0, 'identity': 0.0}
[[34m2025-06-20 08:14:22[0m] Preparing for distributed training...
[[34m2025-06-20 08:14:22[0m] Boosting model for distributed training
[[34m2025-06-20 08:14:22[0m] Training for 10000 epochs with 1000000 steps per epoch
[[34m2025-06-20 08:14:23[0m] Beginning epoch 0...
[[34m2025-06-20 08:20:44[0m] Experiment directory created at /mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla_debug/022-STDiT3-XL-2
[[34m2025-06-20 08:20:44[0m] Training configuration:
 {'adam_eps': 1e-15,
 'batch_size': 4,
 'cache_pin_memory': False,
 'ckpt_every': 10000,
 'config': 'configs/libero/train/sdxl_simplevla_web_mix.py',
 'dataset': {'Ta': 8,
             'To': 4,
             'action_dim': 7,
             'episode_buf_size': 20,
             'episode_per_shard': 30,
             'image_size': (256, 256),
             'sample_buf_size': 2000,
             'shards_pattern1': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/webdataset_shards/06/16_mp/**/*.tar',
             'shards_pattern2': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/webdataset_shards/libero/libero_10_no_noops/**/*.tar',
             'stats_path': '/mnt/hdfs/zhufangqi/datasets/libero/dataset_statistics.json',
             'stride': 1,
             'type': 'MixedSimpleVLAWebDataset',
             'weights': [0.7, 0.3]},
 'dtype': 'bf16',
 'ema_decay': 0.99,
 'epochs': 10000,
 'grad_checkpoint': False,
 'grad_clip': 1.0,
 'load': None,
 'log_every': 10,
 'lr': 0.0001,
 'mask_ratios': {'video_obs_4_frame': 1.0},
 'model': {'action_dim': 7,
           'cfg': False,
           'enable_flash_attn': True,
           'enable_layernorm_kernel': True,
           'freeze_y_embedder': True,
           'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/hpcai-tech/OpenSora-STDiT-v3/model.safetensors',
           'pad_action_num': 4,
           'qk_norm': True,
           'skip_y_embedder': True,
           'training': True,
           'type': 'STDiT3-XL/2'},
 'num_workers': 4,
 'outputs': '/mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla_debug',
 'pin_memory_cache_pre_alloc_numels': [325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560],
 'plugin': 'zero2',
 'record_time': False,
 'scheduler': {'sample_method': 'logit-normal',
               'type': 'rflow',
               'use_timestep_transform': True},
 'seed': 42,
 'start_from_scratch': False,
 'vae': {'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/stabilityai/stable-diffusion-xl-base-1.0/vae',
         'micro_batch_size': 64,
         'micro_frame_size': 8,
         'type': 'SDXL'},
 'wandb': True,
 'warmup_steps': 1000}
[[34m2025-06-20 08:20:48[0m] Building dataset...
[[34m2025-06-20 08:20:48[0m] Dataset contains unknown number of samples.
[[34m2025-06-20 08:20:48[0m] Building models...
[[34m2025-06-20 08:21:03[0m] [Diffusion] Trainable model params: 1.12 B, Total model params: 1.13 B
[[34m2025-06-20 08:21:06[0m] mask ratios: {'video_obs_4_frame': 1.0, 'identity': 0.0}
[[34m2025-06-20 08:21:06[0m] Preparing for distributed training...
[[34m2025-06-20 08:21:06[0m] Boosting model for distributed training
[[34m2025-06-20 08:21:06[0m] Training for 10000 epochs with 1000000 steps per epoch
[[34m2025-06-20 08:21:06[0m] Beginning epoch 0...
[[34m2025-06-20 08:24:36[0m] Experiment directory created at /mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla_debug/023-STDiT3-XL-2
[[34m2025-06-20 08:24:36[0m] Training configuration:
 {'adam_eps': 1e-15,
 'batch_size': 4,
 'cache_pin_memory': False,
 'ckpt_every': 10000,
 'config': 'configs/libero/train/sdxl_simplevla_web_mix.py',
 'dataset': {'Ta': 8,
             'To': 4,
             'action_dim': 7,
             'episode_buf_size': 20,
             'episode_per_shard': 30,
             'image_size': (256, 256),
             'sample_buf_size': 10000,
             'shards_pattern1': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/webdataset_shards/06/16_mp/**/*.tar',
             'shards_pattern2': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/webdataset_shards/libero/libero_10_no_noops/**/*.tar',
             'stats_path': '/mnt/hdfs/zhufangqi/datasets/libero/dataset_statistics.json',
             'stride': 1,
             'type': 'MixedSimpleVLAWebDataset',
             'weights': [0.7, 0.3]},
 'dtype': 'bf16',
 'ema_decay': 0.99,
 'epochs': 10000,
 'grad_checkpoint': False,
 'grad_clip': 1.0,
 'load': None,
 'log_every': 10,
 'lr': 0.0001,
 'mask_ratios': {'video_obs_4_frame': 1.0},
 'model': {'action_dim': 7,
           'cfg': False,
           'enable_flash_attn': True,
           'enable_layernorm_kernel': True,
           'freeze_y_embedder': True,
           'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/hpcai-tech/OpenSora-STDiT-v3/model.safetensors',
           'pad_action_num': 4,
           'qk_norm': True,
           'skip_y_embedder': True,
           'training': True,
           'type': 'STDiT3-XL/2'},
 'num_workers': 0,
 'outputs': '/mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla_debug',
 'pin_memory_cache_pre_alloc_numels': [325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560],
 'plugin': 'zero2',
 'record_time': False,
 'scheduler': {'sample_method': 'logit-normal',
               'type': 'rflow',
               'use_timestep_transform': True},
 'seed': 42,
 'start_from_scratch': False,
 'vae': {'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/stabilityai/stable-diffusion-xl-base-1.0/vae',
         'micro_batch_size': 64,
         'micro_frame_size': 8,
         'type': 'SDXL'},
 'wandb': True,
 'warmup_steps': 1000}
[[34m2025-06-20 08:24:37[0m] Building dataset...
[[34m2025-06-20 08:24:37[0m] Dataset contains unknown number of samples.
[[34m2025-06-20 08:24:37[0m] Building models...
[[34m2025-06-20 08:24:52[0m] [Diffusion] Trainable model params: 1.12 B, Total model params: 1.13 B
[[34m2025-06-20 08:24:55[0m] mask ratios: {'video_obs_4_frame': 1.0, 'identity': 0.0}
[[34m2025-06-20 08:24:55[0m] Preparing for distributed training...
[[34m2025-06-20 08:24:55[0m] Boosting model for distributed training
[[34m2025-06-20 08:24:55[0m] Training for 10000 epochs with 1000000 steps per epoch
[[34m2025-06-20 08:24:55[0m] Beginning epoch 0...
[[34m2025-06-20 08:28:16[0m] Experiment directory created at /mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla_debug/024-STDiT3-XL-2
[[34m2025-06-20 08:28:16[0m] Training configuration:
 {'adam_eps': 1e-15,
 'batch_size': 4,
 'cache_pin_memory': False,
 'ckpt_every': 10000,
 'config': 'configs/libero/train/sdxl_simplevla_web_mix.py',
 'dataset': {'Ta': 8,
             'To': 4,
             'action_dim': 7,
             'episode_buf_size': 10,
             'episode_per_shard': 30,
             'image_size': (256, 256),
             'sample_buf_size': 2000,
             'shards_pattern1': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/webdataset_shards/06/16_mp/**/*.tar',
             'shards_pattern2': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/webdataset_shards/libero/libero_10_no_noops/**/*.tar',
             'stats_path': '/mnt/hdfs/zhufangqi/datasets/libero/dataset_statistics.json',
             'stride': 1,
             'type': 'MixedSimpleVLAWebDataset',
             'weights': [0.7, 0.3]},
 'dtype': 'bf16',
 'ema_decay': 0.99,
 'epochs': 10000,
 'grad_checkpoint': False,
 'grad_clip': 1.0,
 'load': None,
 'log_every': 10,
 'lr': 0.0001,
 'mask_ratios': {'video_obs_4_frame': 1.0},
 'model': {'action_dim': 7,
           'cfg': False,
           'enable_flash_attn': True,
           'enable_layernorm_kernel': True,
           'freeze_y_embedder': True,
           'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/hpcai-tech/OpenSora-STDiT-v3/model.safetensors',
           'pad_action_num': 4,
           'qk_norm': True,
           'skip_y_embedder': True,
           'training': True,
           'type': 'STDiT3-XL/2'},
 'num_workers': 4,
 'outputs': '/mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla_debug',
 'pin_memory_cache_pre_alloc_numels': [325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560],
 'plugin': 'zero2',
 'record_time': False,
 'scheduler': {'sample_method': 'logit-normal',
               'type': 'rflow',
               'use_timestep_transform': True},
 'seed': 42,
 'start_from_scratch': False,
 'vae': {'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/stabilityai/stable-diffusion-xl-base-1.0/vae',
         'micro_batch_size': 64,
         'micro_frame_size': 8,
         'type': 'SDXL'},
 'wandb': True,
 'warmup_steps': 1000}
[[34m2025-06-20 08:28:17[0m] Building dataset...
[[34m2025-06-20 08:28:17[0m] Dataset contains unknown number of samples.
[[34m2025-06-20 08:28:17[0m] Building models...
[[34m2025-06-20 08:28:32[0m] [Diffusion] Trainable model params: 1.12 B, Total model params: 1.13 B
[[34m2025-06-20 08:28:35[0m] mask ratios: {'video_obs_4_frame': 1.0, 'identity': 0.0}
[[34m2025-06-20 08:28:35[0m] Preparing for distributed training...
[[34m2025-06-20 08:28:35[0m] Boosting model for distributed training
[[34m2025-06-20 08:28:35[0m] Training for 10000 epochs with 1000000 steps per epoch
[[34m2025-06-20 08:28:36[0m] Beginning epoch 0...
[[34m2025-06-20 08:31:35[0m] Experiment directory created at /mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla_debug/025-STDiT3-XL-2
[[34m2025-06-20 08:31:35[0m] Training configuration:
 {'adam_eps': 1e-15,
 'batch_size': 4,
 'cache_pin_memory': False,
 'ckpt_every': 10000,
 'config': 'configs/libero/train/sdxl_simplevla_web_mix.py',
 'dataset': {'Ta': 8,
             'To': 4,
             'action_dim': 7,
             'episode_buf_size': 20,
             'episode_per_shard': 30,
             'image_size': (256, 256),
             'sample_buf_size': 2000,
             'shards_pattern1': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/webdataset_shards/06/17_mp/**/*.tar',
             'shards_pattern2': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/webdataset_shards/libero/libero_10_no_noops/**/*.tar',
             'stats_path': '/mnt/hdfs/zhufangqi/datasets/libero/dataset_statistics.json',
             'stride': 1,
             'type': 'MixedSimpleVLAWebDataset',
             'weights': [0.7, 0.3]},
 'dtype': 'bf16',
 'ema_decay': 0.99,
 'epochs': 10000,
 'grad_checkpoint': False,
 'grad_clip': 1.0,
 'load': None,
 'log_every': 10,
 'lr': 0.0001,
 'mask_ratios': {'video_obs_4_frame': 1.0},
 'model': {'action_dim': 7,
           'cfg': False,
           'enable_flash_attn': True,
           'enable_layernorm_kernel': True,
           'freeze_y_embedder': True,
           'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/hpcai-tech/OpenSora-STDiT-v3/model.safetensors',
           'pad_action_num': 4,
           'qk_norm': True,
           'skip_y_embedder': True,
           'training': True,
           'type': 'STDiT3-XL/2'},
 'num_workers': 4,
 'outputs': '/mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla_debug',
 'pin_memory_cache_pre_alloc_numels': [325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560],
 'plugin': 'zero2',
 'record_time': False,
 'scheduler': {'sample_method': 'logit-normal',
               'type': 'rflow',
               'use_timestep_transform': True},
 'seed': 42,
 'start_from_scratch': False,
 'vae': {'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/stabilityai/stable-diffusion-xl-base-1.0/vae',
         'micro_batch_size': 64,
         'micro_frame_size': 8,
         'type': 'SDXL'},
 'wandb': True,
 'warmup_steps': 1000}
[[34m2025-06-20 08:31:37[0m] Building dataset...
[[34m2025-06-20 08:31:37[0m] Dataset contains unknown number of samples.
[[34m2025-06-20 08:31:37[0m] Building models...
[[34m2025-06-20 08:31:51[0m] [Diffusion] Trainable model params: 1.12 B, Total model params: 1.13 B
[[34m2025-06-20 08:31:55[0m] mask ratios: {'video_obs_4_frame': 1.0, 'identity': 0.0}
[[34m2025-06-20 08:31:55[0m] Preparing for distributed training...
[[34m2025-06-20 08:31:55[0m] Boosting model for distributed training
[[34m2025-06-20 08:31:55[0m] Training for 10000 epochs with 1000000 steps per epoch
[[34m2025-06-20 08:31:55[0m] Beginning epoch 0...
[[34m2025-06-20 08:36:52[0m] Experiment directory created at /mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla_debug/026-STDiT3-XL-2
[[34m2025-06-20 08:36:52[0m] Training configuration:
 {'adam_eps': 1e-15,
 'batch_size': 4,
 'cache_pin_memory': False,
 'ckpt_every': 10000,
 'config': 'configs/libero/train/sdxl_simplevla_web_mix.py',
 'dataset': {'Ta': 8,
             'To': 4,
             'action_dim': 7,
             'episode_buf_size': 20,
             'episode_per_shard': 30,
             'image_size': (256, 256),
             'sample_buf_size': 1000,
             'shards_pattern1': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/webdataset_shards/06/17_mp/**/*.tar',
             'shards_pattern2': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/webdataset_shards/libero/libero_10_no_noops/**/*.tar',
             'stats_path': '/mnt/hdfs/zhufangqi/datasets/libero/dataset_statistics.json',
             'stride': 1,
             'type': 'MixedSimpleVLAWebDataset',
             'weights': [0.7, 0.3]},
 'dtype': 'bf16',
 'ema_decay': 0.99,
 'epochs': 10000,
 'grad_checkpoint': False,
 'grad_clip': 1.0,
 'load': None,
 'log_every': 10,
 'lr': 0.0001,
 'mask_ratios': {'video_obs_4_frame': 1.0},
 'model': {'action_dim': 7,
           'cfg': False,
           'enable_flash_attn': True,
           'enable_layernorm_kernel': True,
           'freeze_y_embedder': True,
           'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/hpcai-tech/OpenSora-STDiT-v3/model.safetensors',
           'pad_action_num': 4,
           'qk_norm': True,
           'skip_y_embedder': True,
           'training': True,
           'type': 'STDiT3-XL/2'},
 'num_workers': 4,
 'outputs': '/mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla_debug',
 'pin_memory_cache_pre_alloc_numels': [325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560],
 'plugin': 'zero2',
 'record_time': False,
 'scheduler': {'sample_method': 'logit-normal',
               'type': 'rflow',
               'use_timestep_transform': True},
 'seed': 42,
 'start_from_scratch': False,
 'vae': {'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/stabilityai/stable-diffusion-xl-base-1.0/vae',
         'micro_batch_size': 64,
         'micro_frame_size': 8,
         'type': 'SDXL'},
 'wandb': True,
 'warmup_steps': 1000}
[[34m2025-06-20 08:36:53[0m] Building dataset...
[[34m2025-06-20 08:36:53[0m] Dataset contains unknown number of samples.
[[34m2025-06-20 08:36:53[0m] Building models...
[[34m2025-06-20 08:37:26[0m] [Diffusion] Trainable model params: 1.12 B, Total model params: 1.13 B
[[34m2025-06-20 08:37:29[0m] mask ratios: {'video_obs_4_frame': 1.0, 'identity': 0.0}
[[34m2025-06-20 08:37:29[0m] Preparing for distributed training...
[[34m2025-06-20 08:37:29[0m] Boosting model for distributed training
[[34m2025-06-20 08:37:29[0m] Training for 10000 epochs with 1000000 steps per epoch
[[34m2025-06-20 08:37:29[0m] Beginning epoch 0...
[[34m2025-07-04 05:32:04[0m] Experiment directory created at /mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla/095-STDiT3-XL-2
[[34m2025-07-04 05:32:04[0m] Training configuration:
 {'adam_eps': 1e-15,
 'batch_size': 4,
 'cache_pin_memory': False,
 'ckpt_every': 10000,
 'config': 'configs/libero/train/sdxl_simplevla_web_mix.py',
 'dataset': {'Ta': 8,
             'To': 4,
             'action_dim': 7,
             'episode_buf_size': 10,
             'episode_per_shard': 30,
             'image_size': (256, 256),
             'sample_buf_size': 10000,
             'shards_pattern1': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/debug/170000_split_0.1/train/global_steps=0/**/*.tar',
             'shards_pattern2': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/webdataset_shards/libero/libero_10_no_noops/**/*.tar',
             'stats_path': '/mnt/hdfs/zhufangqi/datasets/libero/dataset_statistics.json',
             'stride': 1,
             'type': 'MixedSimpleVLAWebDataset',
             'weights': [0.7, 0.3]},
 'dtype': 'bf16',
 'ema_decay': 0.99,
 'epochs': 10000,
 'fps': 3,
 'grad_checkpoint': False,
 'grad_clip': 1.0,
 'load': None,
 'log_every': 10,
 'lr': 0.0001,
 'mask_ratios': {'video_obs_4_frame': 1.0},
 'model': {'action_dim': 7,
           'cfg': False,
           'enable_flash_attn': True,
           'enable_layernorm_kernel': True,
           'freeze_y_embedder': True,
           'from_pretrained': '/mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla/000-STDiT3-XL-2/epoch0-global_step170000/ema.pt',
           'pad_action_num': 4,
           'qk_norm': True,
           'skip_y_embedder': True,
           'training': True,
           'type': 'STDiT3-XL/2'},
 'multi_resolution': 'STDiT2',
 'num_workers': 4,
 'outputs': '/mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla',
 'pin_memory_cache_pre_alloc_numels': [325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560],
 'plugin': 'zero2',
 'record_time': False,
 'scheduler': {'sample_method': 'logit-normal',
               'type': 'rflow',
               'use_timestep_transform': True},
 'seed': 42,
 'start_from_scratch': False,
 'vae': {'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/stabilityai/stable-diffusion-xl-base-1.0/vae',
         'micro_batch_size': 64,
         'micro_frame_size': 8,
         'type': 'SDXL'},
 'val_batch_size': 32,
 'val_dataset': {'Ta': 8,
                 'To': 4,
                 'action_dim': 7,
                 'episode_buf_size': 10,
                 'episode_per_shard': 30,
                 'image_size': (256, 256),
                 'sample_buf_size': 500,
                 'shards_pattern': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/webdataset_shards/06/17_mp/**/*.tar',
                 'stats_path': '/mnt/hdfs/zhufangqi/datasets/libero/dataset_statistics.json',
                 'stride': 1,
                 'type': 'SimpleVLAWebDataset'},
 'wandb': True,
 'warmup_steps': 1000}
[[34m2025-07-04 05:32:06[0m] Building dataset...
[[34m2025-07-04 05:32:06[0m] Dataset contains unknown number of samples.
[[34m2025-07-04 05:32:06[0m] Building models...
[[34m2025-07-04 05:32:21[0m] loading pretrained model: /mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla/000-STDiT3-XL-2/epoch0-global_step170000/ema.pt
[[34m2025-07-04 05:32:21[0m] Missing keys: []
[[34m2025-07-04 05:32:21[0m] Unexpected keys: []
[[34m2025-07-04 05:32:24[0m] [Diffusion] Trainable model params: 1.12 B, Total model params: 1.13 B
[[34m2025-07-04 05:32:28[0m] mask ratios: {'video_obs_4_frame': 1.0, 'identity': 0.0}
[[34m2025-07-04 05:32:28[0m] Preparing for distributed training...
[[34m2025-07-04 05:32:28[0m] Boosting model for distributed training
[[34m2025-07-04 05:32:28[0m] Training for 10000 epochs with 1000000 steps per epoch
[[34m2025-07-04 05:32:29[0m] Beginning epoch 0...
[[34m2025-07-04 05:39:37[0m] Experiment directory created at /mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla/096-STDiT3-XL-2
[[34m2025-07-04 05:39:37[0m] Training configuration:
 {'adam_eps': 1e-15,
 'batch_size': 4,
 'cache_pin_memory': False,
 'ckpt_every': 10000,
 'config': 'configs/libero/train/sdxl_simplevla_web_mix.py',
 'dataset': {'Ta': 8,
             'To': 4,
             'action_dim': 7,
             'episode_buf_size': 10,
             'episode_per_shard': 30,
             'image_size': (256, 256),
             'sample_buf_size': 500,
             'shards_pattern1': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/debug/170000_split_0.1/train/global_steps=0/**/*.tar',
             'shards_pattern2': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/webdataset_shards/libero/libero_10_no_noops/**/*.tar',
             'stats_path': '/mnt/hdfs/zhufangqi/datasets/libero/dataset_statistics.json',
             'stride': 1,
             'type': 'MixedSimpleVLAWebDataset',
             'weights': [0.7, 0.3]},
 'dtype': 'bf16',
 'ema_decay': 0.99,
 'epochs': 10000,
 'fps': 3,
 'grad_checkpoint': False,
 'grad_clip': 1.0,
 'load': None,
 'log_every': 10,
 'lr': 0.0001,
 'mask_ratios': {'video_obs_4_frame': 1.0},
 'model': {'action_dim': 7,
           'cfg': False,
           'enable_flash_attn': True,
           'enable_layernorm_kernel': True,
           'freeze_y_embedder': True,
           'from_pretrained': '/mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla/000-STDiT3-XL-2/epoch0-global_step170000/ema.pt',
           'pad_action_num': 4,
           'qk_norm': True,
           'skip_y_embedder': True,
           'training': True,
           'type': 'STDiT3-XL/2'},
 'multi_resolution': 'STDiT2',
 'num_workers': 4,
 'outputs': '/mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla',
 'pin_memory_cache_pre_alloc_numels': [325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560],
 'plugin': 'zero2',
 'record_time': False,
 'scheduler': {'sample_method': 'logit-normal',
               'type': 'rflow',
               'use_timestep_transform': True},
 'seed': 42,
 'start_from_scratch': False,
 'vae': {'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/stabilityai/stable-diffusion-xl-base-1.0/vae',
         'micro_batch_size': 64,
         'micro_frame_size': 8,
         'type': 'SDXL'},
 'val_batch_size': 32,
 'val_dataset': {'Ta': 8,
                 'To': 4,
                 'action_dim': 7,
                 'episode_buf_size': 10,
                 'episode_per_shard': 30,
                 'image_size': (256, 256),
                 'sample_buf_size': 500,
                 'shards_pattern': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/webdataset_shards/06/17_mp/**/*.tar',
                 'stats_path': '/mnt/hdfs/zhufangqi/datasets/libero/dataset_statistics.json',
                 'stride': 1,
                 'type': 'SimpleVLAWebDataset'},
 'wandb': True,
 'warmup_steps': 1000}
[[34m2025-07-04 05:39:38[0m] Building dataset...
[[34m2025-07-04 05:39:38[0m] Dataset contains unknown number of samples.
[[34m2025-07-04 05:39:38[0m] Building models...
[[34m2025-07-04 05:40:03[0m] loading pretrained model: /mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla/000-STDiT3-XL-2/epoch0-global_step170000/ema.pt
[[34m2025-07-04 05:40:04[0m] Missing keys: []
[[34m2025-07-04 05:40:04[0m] Unexpected keys: []
[[34m2025-07-04 05:40:06[0m] [Diffusion] Trainable model params: 1.12 B, Total model params: 1.13 B
[[34m2025-07-04 05:40:10[0m] mask ratios: {'video_obs_4_frame': 1.0, 'identity': 0.0}
[[34m2025-07-04 05:40:10[0m] Preparing for distributed training...
[[34m2025-07-04 05:40:10[0m] Boosting model for distributed training
[[34m2025-07-04 05:40:10[0m] Training for 10000 epochs with 1000000 steps per epoch
[[34m2025-07-04 05:40:13[0m] Beginning epoch 0...
[[34m2025-07-04 05:58:27[0m] Experiment directory created at /mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla/097-STDiT3-XL-2
[[34m2025-07-04 05:58:27[0m] Training configuration:
 {'adam_eps': 1e-15,
 'batch_size': 4,
 'cache_pin_memory': False,
 'ckpt_every': 10000,
 'config': 'configs/libero/train/sdxl_simplevla_web_mix.py',
 'dataset': {'Ta': 8,
             'To': 4,
             'action_dim': 7,
             'episode_buf_size': 20,
             'episode_per_shard': 30,
             'image_size': (256, 256),
             'sample_buf_size': 1000,
             'shards_pattern1': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/debug/170000_split_0.1/train/global_steps=0/**/*.tar',
             'shards_pattern2': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/webdataset_shards/libero/libero_10_no_noops/**/*.tar',
             'stats_path': '/mnt/hdfs/zhufangqi/datasets/libero/dataset_statistics.json',
             'stride': 1,
             'type': 'MixedSimpleVLAWebDataset',
             'weights': [0.7, 0.3]},
 'dtype': 'bf16',
 'ema_decay': 0.99,
 'epochs': 10000,
 'fps': 3,
 'grad_checkpoint': False,
 'grad_clip': 1.0,
 'load': None,
 'log_every': 10,
 'lr': 0.0001,
 'mask_ratios': {'video_obs_4_frame': 1.0},
 'model': {'action_dim': 7,
           'cfg': False,
           'enable_flash_attn': True,
           'enable_layernorm_kernel': True,
           'freeze_y_embedder': True,
           'from_pretrained': '/mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla/000-STDiT3-XL-2/epoch0-global_step170000/ema.pt',
           'pad_action_num': 4,
           'qk_norm': True,
           'skip_y_embedder': True,
           'training': True,
           'type': 'STDiT3-XL/2'},
 'multi_resolution': 'STDiT2',
 'num_workers': 4,
 'outputs': '/mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla',
 'pin_memory_cache_pre_alloc_numels': [325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560],
 'plugin': 'zero2',
 'record_time': False,
 'scheduler': {'sample_method': 'logit-normal',
               'type': 'rflow',
               'use_timestep_transform': True},
 'seed': 42,
 'start_from_scratch': False,
 'vae': {'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/stabilityai/stable-diffusion-xl-base-1.0/vae',
         'micro_batch_size': 64,
         'micro_frame_size': 8,
         'type': 'SDXL'},
 'val_batch_size': 32,
 'val_dataset': {'Ta': 8,
                 'To': 4,
                 'action_dim': 7,
                 'episode_buf_size': 10,
                 'episode_per_shard': 30,
                 'image_size': (256, 256),
                 'sample_buf_size': 500,
                 'shards_pattern': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/webdataset_shards/06/17_mp/**/*.tar',
                 'stats_path': '/mnt/hdfs/zhufangqi/datasets/libero/dataset_statistics.json',
                 'stride': 1,
                 'type': 'SimpleVLAWebDataset'},
 'wandb': True,
 'warmup_steps': 1000}
[[34m2025-07-04 05:58:28[0m] Building dataset...
[[34m2025-07-04 05:58:28[0m] Dataset contains unknown number of samples.
[[34m2025-07-04 05:58:28[0m] Building models...
[[34m2025-07-04 05:58:43[0m] loading pretrained model: /mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla/000-STDiT3-XL-2/epoch0-global_step170000/ema.pt
[[34m2025-07-04 05:58:43[0m] Missing keys: []
[[34m2025-07-04 05:58:43[0m] Unexpected keys: []
[[34m2025-07-04 05:58:45[0m] [Diffusion] Trainable model params: 1.12 B, Total model params: 1.13 B
[[34m2025-07-04 05:58:49[0m] mask ratios: {'video_obs_4_frame': 1.0, 'identity': 0.0}
[[34m2025-07-04 05:58:49[0m] Preparing for distributed training...
[[34m2025-07-04 05:58:49[0m] Boosting model for distributed training
[[34m2025-07-04 05:58:49[0m] Training for 10000 epochs with 1000000 steps per epoch
[[34m2025-07-04 05:58:49[0m] Beginning epoch 0...
[[34m2025-07-04 07:26:49[0m] Experiment directory created at /mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla/104-STDiT3-XL-2
[[34m2025-07-04 07:26:49[0m] Training configuration:
 {'adam_eps': 1e-15,
 'batch_size': 4,
 'cache_pin_memory': False,
 'ckpt_every': 10000,
 'config': 'configs/libero/train/sdxl_simplevla_web_mix.py',
 'dataset': {'Ta': 8,
             'To': 4,
             'action_dim': 7,
             'episode_buf_size': 10,
             'episode_per_shard': 30,
             'image_size': (256, 256),
             'sample_buf_size': 500,
             'shards_pattern1': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/debug/170000_split_0.1/train/global_steps=0/**/*.tar',
             'shards_pattern2': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/webdataset_shards/libero/libero_10_no_noops/**/*.tar',
             'stats_path': '/mnt/hdfs/zhufangqi/datasets/libero/dataset_statistics.json',
             'stride': 1,
             'type': 'MixedSimpleVLAWebDataset',
             'weights': [0.7, 0.3]},
 'dtype': 'bf16',
 'ema_decay': 0.99,
 'epochs': 10000,
 'fps': 3,
 'grad_checkpoint': False,
 'grad_clip': 1.0,
 'load': None,
 'log_every': 10,
 'lr': 0.0001,
 'mask_ratios': {'video_obs_4_frame': 1.0},
 'model': {'action_dim': 7,
           'cfg': False,
           'enable_flash_attn': True,
           'enable_layernorm_kernel': True,
           'freeze_y_embedder': True,
           'from_pretrained': '/mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla/000-STDiT3-XL-2/epoch0-global_step170000/ema.pt',
           'pad_action_num': 4,
           'qk_norm': True,
           'skip_y_embedder': True,
           'training': True,
           'type': 'STDiT3-XL/2'},
 'multi_resolution': 'STDiT2',
 'num_workers': 4,
 'outputs': '/mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla',
 'pin_memory_cache_pre_alloc_numels': [325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560],
 'plugin': 'zero2',
 'record_time': False,
 'scheduler': {'sample_method': 'logit-normal',
               'type': 'rflow',
               'use_timestep_transform': True},
 'seed': 42,
 'start_from_scratch': False,
 'vae': {'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/stabilityai/stable-diffusion-xl-base-1.0/vae',
         'micro_batch_size': 64,
         'micro_frame_size': 8,
         'type': 'SDXL'},
 'val_batch_size': 32,
 'val_dataset': {'Ta': 8,
                 'To': 4,
                 'action_dim': 7,
                 'episode_buf_size': 20,
                 'episode_per_shard': 30,
                 'image_size': (256, 256),
                 'sample_buf_size': 500,
                 'shards_pattern': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/webdataset_shards/06/17_mp/**/*.tar',
                 'stats_path': '/mnt/hdfs/zhufangqi/datasets/libero/dataset_statistics.json',
                 'stride': 1,
                 'type': 'SimpleVLAWebDataset'},
 'wandb': True,
 'warmup_steps': 1000}
[[34m2025-07-04 07:26:50[0m] Building dataset...
[[34m2025-07-04 07:26:50[0m] Dataset contains unknown number of samples.
[[34m2025-07-04 07:26:50[0m] Building models...
[[34m2025-07-04 07:27:05[0m] loading pretrained model: /mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla/000-STDiT3-XL-2/epoch0-global_step170000/ema.pt
[[34m2025-07-04 07:27:06[0m] Missing keys: []
[[34m2025-07-04 07:27:06[0m] Unexpected keys: []
[[34m2025-07-04 07:27:08[0m] [Diffusion] Trainable model params: 1.12 B, Total model params: 1.13 B
[[34m2025-07-04 07:27:12[0m] mask ratios: {'video_obs_4_frame': 1.0, 'identity': 0.0}
[[34m2025-07-04 07:27:12[0m] Preparing for distributed training...
[[34m2025-07-04 07:27:13[0m] Boosting model for distributed training
[[34m2025-07-04 07:27:13[0m] Training for 10000 epochs with 1000000 steps per epoch
[[34m2025-07-04 07:27:13[0m] Beginning epoch 0...
[[34m2025-07-04 11:36:30[0m] Experiment directory created at /mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla/112-STDiT3-XL-2
[[34m2025-07-04 11:36:30[0m] Training configuration:
 {'adam_eps': 1e-15,
 'batch_size': 4,
 'cache_pin_memory': False,
 'ckpt_every': 10000,
 'config': 'configs/libero/train/sdxl_simplevla_web_mix.py',
 'dataset': {'Ta': 8,
             'To': 4,
             'action_dim': 7,
             'episode_buf_size': 10,
             'episode_per_shard': 30,
             'image_size': (256, 256),
             'sample_buf_size': 500,
             'shards_pattern1': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/debug/170000/**/*.tar',
             'shards_pattern2': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/webdataset_shards/libero/libero_10_no_noops/**/*.tar',
             'stats_path': '/mnt/hdfs/zhufangqi/datasets/libero/dataset_statistics.json',
             'stride': 1,
             'type': 'MixedSimpleVLAWebDataset',
             'weights': [0.7, 0.3]},
 'dtype': 'bf16',
 'ema_decay': 0.99,
 'epochs': 10000,
 'fps': 3,
 'grad_checkpoint': False,
 'grad_clip': 1.0,
 'load': None,
 'log_every': 10,
 'lr': 0.0001,
 'mask_ratios': {'video_obs_4_frame': 1.0},
 'model': {'action_dim': 7,
           'cfg': False,
           'enable_flash_attn': True,
           'enable_layernorm_kernel': True,
           'freeze_y_embedder': True,
           'from_pretrained': '/mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla/000-STDiT3-XL-2/epoch0-global_step170000/ema.pt',
           'pad_action_num': 4,
           'qk_norm': True,
           'skip_y_embedder': True,
           'training': True,
           'type': 'STDiT3-XL/2'},
 'multi_resolution': 'STDiT2',
 'num_workers': 4,
 'outputs': '/mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla',
 'pin_memory_cache_pre_alloc_numels': [325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560],
 'plugin': 'zero2',
 'record_time': False,
 'scheduler': {'sample_method': 'logit-normal',
               'type': 'rflow',
               'use_timestep_transform': True},
 'seed': 42,
 'start_from_scratch': False,
 'vae': {'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/stabilityai/stable-diffusion-xl-base-1.0/vae',
         'micro_batch_size': 64,
         'micro_frame_size': 8,
         'type': 'SDXL'},
 'val_batch_size': 32,
 'val_dataset': {'Ta': 8,
                 'To': 4,
                 'action_dim': 7,
                 'episode_buf_size': 20,
                 'episode_per_shard': 30,
                 'image_size': (256, 256),
                 'sample_buf_size': 500,
                 'shards_pattern': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/webdataset_shards/06/17_mp/**/*.tar',
                 'stats_path': '/mnt/hdfs/zhufangqi/datasets/libero/dataset_statistics.json',
                 'stride': 1,
                 'type': 'SimpleVLAWebDataset'},
 'wandb': True,
 'warmup_steps': 1000}
[[34m2025-07-04 11:36:31[0m] Building dataset...
[[34m2025-07-04 11:36:31[0m] Dataset contains unknown number of samples.
[[34m2025-07-04 11:36:31[0m] Building models...
[[34m2025-07-04 11:36:46[0m] loading pretrained model: /mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla/000-STDiT3-XL-2/epoch0-global_step170000/ema.pt
[[34m2025-07-04 11:36:47[0m] Missing keys: []
[[34m2025-07-04 11:36:47[0m] Unexpected keys: []
[[34m2025-07-04 11:36:50[0m] [Diffusion] Trainable model params: 1.12 B, Total model params: 1.13 B
[[34m2025-07-04 11:36:53[0m] mask ratios: {'video_obs_4_frame': 1.0, 'identity': 0.0}
[[34m2025-07-04 11:36:53[0m] Preparing for distributed training...
[[34m2025-07-04 11:36:54[0m] Boosting model for distributed training
[[34m2025-07-04 11:36:54[0m] Training for 10000 epochs with 1000000 steps per epoch
[[34m2025-07-04 11:36:55[0m] Beginning epoch 0...
[[34m2025-07-04 11:42:24[0m] Experiment directory created at /mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla/113-STDiT3-XL-2
[[34m2025-07-04 11:42:24[0m] Training configuration:
 {'adam_eps': 1e-15,
 'batch_size': 4,
 'cache_pin_memory': False,
 'ckpt_every': 10000,
 'config': 'configs/libero/train/sdxl_simplevla_web_mix.py',
 'dataset': {'Ta': 8,
             'To': 4,
             'action_dim': 7,
             'episode_buf_size': 10,
             'episode_per_shard': 30,
             'image_size': (256, 256),
             'sample_buf_size': 500,
             'shards_pattern1': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/debug/170000_split_0.1/**/*.tar',
             'shards_pattern2': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/webdataset_shards/libero/libero_10_no_noops/**/*.tar',
             'stats_path': '/mnt/hdfs/zhufangqi/datasets/libero/dataset_statistics.json',
             'stride': 1,
             'type': 'MixedSimpleVLAWebDataset',
             'weights': [0.7, 0.3]},
 'dtype': 'bf16',
 'ema_decay': 0.99,
 'epochs': 10000,
 'fps': 3,
 'grad_checkpoint': False,
 'grad_clip': 1.0,
 'load': None,
 'log_every': 10,
 'lr': 0.0001,
 'mask_ratios': {'video_obs_4_frame': 1.0},
 'model': {'action_dim': 7,
           'cfg': False,
           'enable_flash_attn': True,
           'enable_layernorm_kernel': True,
           'freeze_y_embedder': True,
           'from_pretrained': '/mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla/000-STDiT3-XL-2/epoch0-global_step170000/ema.pt',
           'pad_action_num': 4,
           'qk_norm': True,
           'skip_y_embedder': True,
           'training': True,
           'type': 'STDiT3-XL/2'},
 'multi_resolution': 'STDiT2',
 'num_workers': 4,
 'outputs': '/mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla',
 'pin_memory_cache_pre_alloc_numels': [325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560,
                                       325058560],
 'plugin': 'zero2',
 'record_time': False,
 'scheduler': {'sample_method': 'logit-normal',
               'type': 'rflow',
               'use_timestep_transform': True},
 'seed': 42,
 'start_from_scratch': False,
 'vae': {'from_pretrained': '/mnt/hdfs/zhufangqi/pretrained_models/stabilityai/stable-diffusion-xl-base-1.0/vae',
         'micro_batch_size': 64,
         'micro_frame_size': 8,
         'type': 'SDXL'},
 'val_batch_size': 32,
 'val_dataset': {'Ta': 8,
                 'To': 4,
                 'action_dim': 7,
                 'episode_buf_size': 20,
                 'episode_per_shard': 30,
                 'image_size': (256, 256),
                 'sample_buf_size': 500,
                 'shards_pattern': '/mnt/hdfs/zhufangqi/datasets/simplevla_rl/webdataset_shards/06/17_mp/**/*.tar',
                 'stats_path': '/mnt/hdfs/zhufangqi/datasets/libero/dataset_statistics.json',
                 'stride': 1,
                 'type': 'SimpleVLAWebDataset'},
 'wandb': True,
 'warmup_steps': 1000}
[[34m2025-07-04 11:42:27[0m] Building dataset...
[[34m2025-07-04 11:42:28[0m] Dataset contains unknown number of samples.
[[34m2025-07-04 11:42:28[0m] Building models...
[[34m2025-07-04 11:42:43[0m] loading pretrained model: /mnt/hdfs/zhufangqi/checkpoints/opensora/libero/06/20/sdxl_simplevla/000-STDiT3-XL-2/epoch0-global_step170000/ema.pt
[[34m2025-07-04 11:42:43[0m] Missing keys: []
[[34m2025-07-04 11:42:43[0m] Unexpected keys: []
[[34m2025-07-04 11:42:46[0m] [Diffusion] Trainable model params: 1.12 B, Total model params: 1.13 B
[[34m2025-07-04 11:42:49[0m] mask ratios: {'video_obs_4_frame': 1.0, 'identity': 0.0}
[[34m2025-07-04 11:42:49[0m] Preparing for distributed training...
[[34m2025-07-04 11:42:50[0m] Boosting model for distributed training
[[34m2025-07-04 11:42:50[0m] Training for 10000 epochs with 1000000 steps per epoch
[[34m2025-07-04 11:42:50[0m] Beginning epoch 0...
